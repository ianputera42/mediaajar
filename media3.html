<!doctype html>
<html lang="id" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Generator Presentasi Canva</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script><!-- Professional Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&amp;family=Playfair+Display:wght@400;500;600;700;800&amp;family=Source+Sans+Pro:wght@300;400;600;700&amp;display=swap" rel="stylesheet">
  <style>
        body {
            box-sizing: border-box;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-hover {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        .loading-spinner {
            border: 3px solid #f3f4f6;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .slide-preview {
            width: 1024px;
            height: 768px;
            max-width: 100%;
            aspect-ratio: 4/3;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 3rem;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            margin: 0 auto 2rem auto;
            position: relative;
            overflow: hidden;
        }
        
        @media (max-width: 1200px) {
            .slide-preview {
                width: 90vw;
                height: calc(90vw * 3/4);
                padding: 2rem;
            }
        }
        
        @media (max-width: 768px) {
            .slide-preview {
                width: 95vw;
                height: calc(95vw * 3/4);
                padding: 1.5rem;
            }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .pulse {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        .slide-navigation {
            position: sticky;
            top: 20px;
            z-index: 10;
        }
        
        /* Enhanced Animations and Graphics */
        .floating-animation {
            animation: floating 3s ease-in-out infinite;
        }
        @keyframes floating {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .rotate-animation {
            animation: rotate 8s linear infinite;
        }
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .bounce-animation {
            animation: bounce 2s infinite;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
        
        .pulse-glow {
            animation: pulseGlow 2s ease-in-out infinite alternate;
        }
        @keyframes pulseGlow {
            from { box-shadow: 0 0 20px rgba(255, 255, 255, 0.3); }
            to { box-shadow: 0 0 30px rgba(255, 255, 255, 0.6); }
        }
        
        .slide-in-left {
            animation: slideInLeft 1s ease-out;
        }
        @keyframes slideInLeft {
            from { transform: translateX(-100px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .slide-in-right {
            animation: slideInRight 1s ease-out;
        }
        @keyframes slideInRight {
            from { transform: translateX(100px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .zoom-in {
            animation: zoomIn 0.8s ease-out;
        }
        @keyframes zoomIn {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .typewriter {
            overflow: hidden;
            border-right: 3px solid;
            white-space: nowrap;
            animation: typewriter 3s steps(40) 1s both, blink 0.75s step-end infinite;
        }
        @keyframes typewriter {
            from { width: 0; }
            to { width: 100%; }
        }
        @keyframes blink {
            50% { border-color: transparent; }
        }
        
        .particle-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none;
        }
        
        .particle {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: particleFloat 6s infinite linear;
        }
        @keyframes particleFloat {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
        }
        
        .wave-animation {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100px;
            background: linear-gradient(45deg, rgba(255,255,255,0.1), rgba(255,255,255,0.3));
            clip-path: polygon(0 50%, 100% 80%, 100% 100%, 0% 100%);
            animation: wave 4s ease-in-out infinite;
        }
        @keyframes wave {
            0%, 100% { clip-path: polygon(0 50%, 100% 80%, 100% 100%, 0% 100%); }
            50% { clip-path: polygon(0 80%, 100% 50%, 100% 100%, 0% 100%); }
        }
        
        .geometric-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.1;
            background-image: 
                linear-gradient(45deg, transparent 40%, rgba(255,255,255,0.1) 50%, transparent 60%),
                linear-gradient(-45deg, transparent 40%, rgba(255,255,255,0.1) 50%, transparent 60%);
            background-size: 60px 60px;
            animation: geometricMove 10s linear infinite;
        }
        @keyframes geometricMove {
            0% { background-position: 0 0, 0 0; }
            100% { background-position: 60px 60px, -60px 60px; }
        }
        
        /* Educational Visual Elements */
        .student-illustration {
            position: absolute;
            opacity: 0.15;
            animation: studentMove 8s ease-in-out infinite;
        }
        @keyframes studentMove {
            0%, 100% { transform: translateY(0px) scale(1); }
            50% { transform: translateY(-15px) scale(1.05); }
        }
        
        .school-building {
            position: absolute;
            opacity: 0.1;
            animation: buildingGlow 6s ease-in-out infinite;
        }
        @keyframes buildingGlow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.3); }
        }
        
        .classroom-elements {
            position: absolute;
            opacity: 0.2;
            animation: classroomFloat 5s ease-in-out infinite;
        }
        @keyframes classroomFloat {
            0%, 100% { transform: translateX(0px) rotate(0deg); }
            50% { transform: translateX(10px) rotate(2deg); }
        }
        
        .book-stack {
            position: absolute;
            animation: bookWiggle 4s ease-in-out infinite;
        }
        @keyframes bookWiggle {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(2deg); }
            75% { transform: rotate(-2deg); }
        }
        
        .graduation-cap {
            position: absolute;
            animation: capFloat 6s ease-in-out infinite;
        }
        @keyframes capFloat {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }
        
        .pencil-animation {
            position: absolute;
            animation: pencilWrite 3s ease-in-out infinite;
        }
        @keyframes pencilWrite {
            0%, 100% { transform: translateX(0px) rotate(0deg); }
            50% { transform: translateX(15px) rotate(10deg); }
        }
        
        .chalkboard {
            position: absolute;
            background: #2d5016;
            border: 8px solid #8B4513;
            border-radius: 8px;
            opacity: 0.15;
            animation: chalkboardShine 8s ease-in-out infinite;
        }
        @keyframes chalkboardShine {
            0%, 100% { box-shadow: inset 0 0 20px rgba(255,255,255,0.1); }
            50% { box-shadow: inset 0 0 40px rgba(255,255,255,0.2); }
        }
        
        .apple-teacher {
            position: absolute;
            animation: appleRoll 10s linear infinite;
        }
        @keyframes appleRoll {
            0% { transform: translateX(-50px) rotate(0deg); }
            100% { transform: translateX(50px) rotate(360deg); }
        }
        
        .lightbulb-idea {
            position: absolute;
            animation: lightbulbGlow 2s ease-in-out infinite alternate;
        }
        @keyframes lightbulbGlow {
            from { filter: brightness(1) drop-shadow(0 0 5px rgba(255,255,0,0.3)); }
            to { filter: brightness(1.5) drop-shadow(0 0 15px rgba(255,255,0,0.8)); }
        }
        
        .student-group {
            position: absolute;
            animation: groupDiscussion 6s ease-in-out infinite;
        }
        @keyframes groupDiscussion {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .trophy-achievement {
            position: absolute;
            animation: trophyShine 4s ease-in-out infinite;
        }
        @keyframes trophyShine {
            0%, 100% { transform: scale(1) rotate(0deg); filter: brightness(1); }
            50% { transform: scale(1.1) rotate(5deg); filter: brightness(1.3); }
        }
        
        .calculator-math {
            position: absolute;
            animation: calculatorPress 3s ease-in-out infinite;
        }
        @keyframes calculatorPress {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(0.95); }
        }
        
        .microscope-science {
            position: absolute;
            animation: microscopeAdjust 5s ease-in-out infinite;
        }
        @keyframes microscopeAdjust {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(3deg); }
        }
        
        .globe-geography {
            position: absolute;
            animation: globeRotate 12s linear infinite;
        }
        @keyframes globeRotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .palette-art {
            position: absolute;
            animation: paletteColor 4s ease-in-out infinite;
        }
        @keyframes paletteColor {
            0%, 100% { filter: hue-rotate(0deg); }
            50% { filter: hue-rotate(180deg); }
        }
        
        .dna-helix {
            position: absolute;
            right: 10%;
            top: 20%;
            width: 100px;
            height: 300px;
            opacity: 0.3;
        }
        
        .dna-strand {
            position: absolute;
            width: 4px;
            height: 100%;
            background: linear-gradient(to bottom, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4);
            border-radius: 2px;
            animation: dnaRotate 4s linear infinite;
        }
        
        .dna-strand:nth-child(1) { left: 20px; }
        .dna-strand:nth-child(2) { right: 20px; animation-delay: -2s; }
        
        @keyframes dnaRotate {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(360deg); }
        }
        
        .math-formula {
            position: absolute;
            font-size: 24px;
            opacity: 0.2;
            color: white;
            animation: mathFloat 8s ease-in-out infinite;
        }
        @keyframes mathFloat {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-20px) rotate(5deg); }
            50% { transform: translateY(-10px) rotate(-3deg); }
            75% { transform: translateY(-15px) rotate(2deg); }
        }
        
        .leaf-animation {
            position: absolute;
            width: 30px;
            height: 30px;
            background: #4CAF50;
            border-radius: 0 100% 0 100%;
            animation: leafFall 6s ease-in-out infinite;
        }
        @keyframes leafFall {
            0% { transform: translateY(-50px) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(400px) rotate(180deg); opacity: 0; }
        }
        
        .heartbeat {
            animation: heartbeat 1.5s ease-in-out infinite;
        }
        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .book-flip {
            animation: bookFlip 3s ease-in-out infinite;
        }
        @keyframes bookFlip {
            0%, 100% { transform: rotateY(0deg); }
            50% { transform: rotateY(180deg); }
        }
        
        .globe-spin {
            animation: globeSpin 10s linear infinite;
        }
        @keyframes globeSpin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .circuit-lines {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.1;
            background-image: 
                linear-gradient(90deg, transparent 48%, #00ff88 50%, transparent 52%),
                linear-gradient(0deg, transparent 48%, #00ff88 50%, transparent 52%);
            background-size: 100px 100px;
            animation: circuitPulse 3s ease-in-out infinite;
        }
        @keyframes circuitPulse {
            0%, 100% { opacity: 0.1; }
            50% { opacity: 0.3; }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full bg-gray-50">
  <div class="min-h-full"><!-- Header -->
   <header class="gradient-bg shadow-lg">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
     <div class="flex justify-between items-center py-6">
      <div class="flex items-center">
       <div class="flex-shrink-0">
        <svg class="h-8 w-8 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 4V2a1 1 0 011-1h8a1 1 0 011 1v2h4a1 1 0 110 2h-1v12a2 2 0 01-2 2H6a2 2 0 01-2-2V6H3a1 1 0 110-2h4zM9 3v1h6V3H9zm2 5a1 1 0 011 1v6a1 1 0 11-2 0V9a1 1 0 011-1zm4 0a1 1 0 011 1v6a1 1 0 11-2 0V9a1 1 0 011-1z"></path>
        </svg>
       </div>
       <div class="ml-4">
        <h1 id="app-title" class="text-2xl font-bold text-white">Generator Presentasi Canva</h1>
        <p id="welcome-text" class="text-indigo-100">Buat presentasi Canva yang menakjubkan dalam hitungan detik</p>
       </div>
      </div>
      <div class="flex items-center space-x-4">
       <div class="text-white text-sm"><span class="bg-white bg-opacity-20 px-3 py-1 rounded-full">🎨 Desain Siap Pakai</span>
       </div>
      </div>
     </div>
    </div>
   </header><!-- Main Content -->
   <main class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
    <div class="px-4 py-6 sm:px-0"><!-- Generator Form -->
     <div class="bg-white shadow rounded-lg mb-8">
      <div class="px-4 py-5 sm:p-6">
       <div class="flex items-center justify-between mb-6">
        <h3 class="text-lg leading-6 font-medium text-gray-900">🎯 Generator Presentasi Pembelajaran</h3>
        <div class="text-sm text-gray-500"><span class="bg-green-100 text-green-800 px-2 py-1 rounded-full">✨ Instant Generate</span>
        </div>
       </div>
       <form id="presentation-form" class="space-y-8"><!-- Enhanced Input Section -->
        <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200">
         <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center"><span class="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold mr-3">1</span> 📝 Informasi Dasar Pembelajaran</h4>
         <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="space-y-2"><label for="penyusun" class="block text-sm font-semibold text-gray-700 flex items-center"> <span class="mr-2">👨‍🏫</span>Nama Guru/Penyusun </label> <input type="text" id="penyusun" name="penyusun" required class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200 text-sm font-medium" placeholder="Masukkan nama lengkap Anda">
           <p class="text-xs text-gray-500 mt-1">Nama akan muncul di slide pembuka dan penutup</p>
          </div>
          <div class="space-y-2"><label for="mata_pelajaran" class="block text-sm font-semibold text-gray-700 flex items-center"> <span class="mr-2">📚</span>Mata Pelajaran </label> <input type="text" id="mata_pelajaran" name="mata_pelajaran" required class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200 text-sm font-medium" placeholder="Contoh: Matematika, IPA, Bahasa Indonesia" list="mata-pelajaran-suggestions"> <datalist id="mata-pelajaran-suggestions"> <option value="Matematika"> </option><option value="IPA (Ilmu Pengetahuan Alam)"> </option><option value="Bahasa Indonesia"> </option><option value="Bahasa Inggris"> </option><option value="IPS (Ilmu Pengetahuan Sosial)"> </option><option value="Fisika"> </option><option value="Kimia"> </option><option value="Biologi"> </option><option value="Sejarah"> </option><option value="Geografi"> </option><option value="Ekonomi"> </option><option value="Seni Budaya"> </option><option value="Pendidikan Jasmani"> </option><option value="PKn (Pendidikan Kewarganegaraan)"> </option><option value="Teknologi Informasi"> </option></datalist>
           <p class="text-xs text-gray-500 mt-1">Template akan dipilih otomatis berdasarkan mata pelajaran</p>
          </div>
          <div class="space-y-2"><label for="kelas_fase" class="block text-sm font-semibold text-gray-700 flex items-center"> <span class="mr-2">🎓</span>Kelas/Fase </label> <select id="kelas_fase" name="kelas_fase" required class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200 text-sm font-medium"> <option value="">Pilih Kelas/Fase</option> <optgroup label="🏫 Sekolah Dasar (SD)"> <option value="Kelas 1 SD">Kelas 1 SD</option> <option value="Kelas 2 SD">Kelas 2 SD</option> <option value="Kelas 3 SD">Kelas 3 SD</option> <option value="Kelas 4 SD">Kelas 4 SD</option> <option value="Kelas 5 SD">Kelas 5 SD</option> <option value="Kelas 6 SD">Kelas 6 SD</option> </optgroup> <optgroup label="🏫 Sekolah Menengah Pertama (SMP)"> <option value="Kelas 7 SMP">Kelas 7 SMP</option> <option value="Kelas 8 SMP">Kelas 8 SMP</option> <option value="Kelas 9 SMP">Kelas 9 SMP</option> </optgroup> <optgroup label="🏫 Sekolah Menengah Atas (SMA)"> <option value="Kelas 10 SMA">Kelas 10 SMA</option> <option value="Kelas 11 SMA">Kelas 11 SMA</option> <option value="Kelas 12 SMA">Kelas 12 SMA</option> </optgroup> <optgroup label="📚 Kurikulum Merdeka"> <option value="Fase A (Kelas 1-2)">Fase A (Kelas 1-2)</option> <option value="Fase B (Kelas 3-4)">Fase B (Kelas 3-4)</option> <option value="Fase C (Kelas 5-6)">Fase C (Kelas 5-6)</option> <option value="Fase D (Kelas 7-9)">Fase D (Kelas 7-9)</option> <option value="Fase E (Kelas 10)">Fase E (Kelas 10)</option> <option value="Fase F (Kelas 11-12)">Fase F (Kelas 11-12)</option> </optgroup> </select>
           <p class="text-xs text-gray-500 mt-1">Konten akan disesuaikan dengan tingkat kelas</p>
          </div>
          <div class="space-y-2"><label for="topik_materi" class="block text-sm font-semibold text-gray-700 flex items-center"> <span class="mr-2">📖</span>Topik/Materi Pembelajaran </label> <input type="text" id="topik_materi" name="topik_materi" required class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200 text-sm font-medium" placeholder="Contoh: Pecahan, Fotosintesis, Teks Narasi">
           <p class="text-xs text-gray-500 mt-1">Topik spesifik yang akan diajarkan hari ini</p>
          </div>
         </div>
        </div><!-- Advanced Options -->
        <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-6 border border-purple-200">
         <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center"><span class="bg-purple-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold mr-3">2</span> ⚙️ Pengaturan Lanjutan (Opsional)</h4>
         <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div class="space-y-2"><label for="durasi_pembelajaran" class="block text-sm font-semibold text-gray-700 flex items-center"> <span class="mr-2">⏰</span>Durasi Pembelajaran </label> <select id="durasi_pembelajaran" name="durasi_pembelajaran" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-200 text-sm font-medium"> <option value="45">45 menit (1 JP)</option> <option value="90" selected>90 menit (2 JP)</option> <option value="135">135 menit (3 JP)</option> <option value="180">180 menit (4 JP)</option> </select>
          </div>
          <div class="space-y-2"><label for="metode_pembelajaran" class="block text-sm font-semibold text-gray-700 flex items-center"> <span class="mr-2">🎯</span>Metode Pembelajaran </label> <select id="metode_pembelajaran" name="metode_pembelajaran" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-200 text-sm font-medium"> <option value="interaktif" selected>Interaktif &amp; Diskusi</option> <option value="eksperimen">Eksperimen &amp; Praktik</option> <option value="ceramah">Ceramah &amp; Presentasi</option> <option value="kolaboratif">Kolaboratif &amp; Kelompok</option> <option value="discovery">Discovery Learning</option> <option value="problem_based">Problem Based Learning</option> </select>
          </div>
          <div class="space-y-2"><label for="tingkat_kesulitan" class="block text-sm font-semibold text-gray-700 flex items-center"> <span class="mr-2">📊</span>Tingkat Kesulitan </label> <select id="tingkat_kesulitan" name="tingkat_kesulitan" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-200 text-sm font-medium"> <option value="dasar">Dasar (Pengenalan)</option> <option value="menengah" selected>Menengah (Pemahaman)</option> <option value="lanjut">Lanjut (Analisis)</option> <option value="mahir">Mahir (Sintesis)</option> </select>
          </div>
         </div>
        </div><!-- AI Theme Recommendation Section -->
        <div class="bg-gradient-to-r from-green-50 to-teal-50 rounded-xl p-6 border border-green-200">
         <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center"><span class="bg-green-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold mr-3">3</span> 🤖 AI Rekomendasi Tema Otomatis</h4><!-- AI Theme Recommendation Display -->
         <div class="p-4 bg-white rounded-lg border border-green-200 shadow-sm">
          <div class="flex items-center justify-between mb-3">
           <h5 class="font-semibold text-gray-800 flex items-center"><span class="mr-2">🎨</span>Tema Dipilih Otomatis</h5><span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full font-medium">AI Powered</span>
          </div>
          <p class="text-sm text-gray-600 mb-4">AI akan menganalisis mata pelajaran dan topik pembelajaran untuk memilih tema visual yang paling sesuai</p><!-- Auto-Selected Theme Display -->
          <div id="selected-theme-display" class="p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200 hidden">
           <div class="flex items-center justify-between mb-3">
            <div class="flex items-center"><span id="selected-theme-icon" class="text-blue-600 mr-3 text-2xl">🔢</span>
             <div><span class="text-sm font-semibold text-blue-800">Tema Terpilih:</span> <span id="selected-theme-name" class="ml-2 text-sm text-blue-700 font-bold">Matematika Modern</span>
             </div>
            </div><span class="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full">98% Akurat</span>
           </div>
           <p id="selected-theme-desc" class="text-xs text-blue-600 mb-2 ml-11 italic">Desain geometris dengan elemen visual matematika</p>
           <div class="ml-11"><span class="text-xs text-blue-700 font-medium">Faktor Pemilihan: </span> <span id="selected-theme-features" class="text-xs text-blue-600">Mata pelajaran: matematika • Topik: pecahan</span>
           </div>
          </div><!-- AI Analysis Info -->
          <div class="mt-4 p-3 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg border border-purple-200">
           <div class="flex items-center justify-between text-xs text-purple-700"><span>🧠 Analisis AI berdasarkan konteks pembelajaran</span> <span>⚡ Pemilihan tema dalam hitungan detik</span> <span>🎯 Disesuaikan dengan kurikulum Indonesia</span>
           </div>
          </div>
         </div>
        </div><!-- Enhanced Generate Button Section -->
        <div class="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl p-6 border border-indigo-200">
         <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center"><span class="bg-indigo-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold mr-3">4</span> 🚀 Generate Presentasi Profesional</h4><!-- Generation Preview -->
         <div class="mb-6 p-4 bg-white rounded-lg border border-indigo-200 shadow-sm">
          <h5 class="font-semibold text-gray-800 mb-3 flex items-center"><span class="mr-2">📋</span>Yang Akan Dibuat:</h5>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
           <div class="space-y-2">
            <div class="flex items-center text-gray-700"><span class="w-2 h-2 bg-green-500 rounded-full mr-3"></span> <span>10 slide lengkap dengan konten edukatif</span>
            </div>
            <div class="flex items-center text-gray-700"><span class="w-2 h-2 bg-green-500 rounded-full mr-3"></span> <span>Desain profesional siap Canva</span>
            </div>
            <div class="flex items-center text-gray-700"><span class="w-2 h-2 bg-green-500 rounded-full mr-3"></span> <span>Materi disesuaikan tingkat kelas</span>
            </div>
            <div class="flex items-center text-gray-700"><span class="w-2 h-2 bg-green-500 rounded-full mr-3"></span> <span>Aktivitas praktik dan evaluasi</span>
            </div>
           </div>
           <div class="space-y-2">
            <div class="flex items-center text-gray-700"><span class="w-2 h-2 bg-blue-500 rounded-full mr-3"></span> <span>Format 4:3 (1024×768px)</span>
            </div>
            <div class="flex items-center text-gray-700"><span class="w-2 h-2 bg-blue-500 rounded-full mr-3"></span> <span>Template visual menarik</span>
            </div>
            <div class="flex items-center text-gray-700"><span class="w-2 h-2 bg-blue-500 rounded-full mr-3"></span> <span>Navigasi slide interaktif</span>
            </div>
            <div class="flex items-center text-gray-700"><span class="w-2 h-2 bg-blue-500 rounded-full mr-3"></span> <span>File JSON untuk Canva</span>
            </div>
           </div>
          </div>
         </div><!-- Generation Time Estimate -->
         <div class="mb-6 p-3 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg border border-yellow-200">
          <div class="flex items-center justify-between">
           <div class="flex items-center"><span class="text-yellow-600 mr-2">⏱️</span> <span class="text-sm font-medium text-yellow-800">Estimasi Waktu: 3-5 detik</span>
           </div>
           <div class="flex items-center space-x-4 text-xs text-yellow-700"><span>🤖 AI Processing</span> <span>🎨 Design Generation</span> <span>📝 Content Creation</span>
           </div>
          </div>
         </div><!-- Generate Button -->
         <div class="flex flex-col items-center space-y-4"><button type="submit" id="generate-btn" class="group relative bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white px-12 py-4 rounded-xl font-bold text-lg transition-all duration-300 flex items-center shadow-xl hover:shadow-2xl transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none"> <span id="generate-text" class="flex items-center"> <span class="mr-3 text-2xl group-hover:animate-bounce">🚀</span> Generate Presentasi Canva </span>
           <div id="generate-spinner" class="loading-spinner ml-4 hidden"></div><!-- Button Glow Effect -->
           <div class="absolute inset-0 rounded-xl bg-gradient-to-r from-indigo-400 to-purple-400 opacity-0 group-hover:opacity-20 transition-opacity duration-300"></div></button> <!-- Progress Indicator -->
          <div id="generation-progress" class="hidden w-full max-w-md">
           <div class="flex items-center justify-between text-sm text-gray-600 mb-2"><span id="progress-text">Memproses data...</span> <span id="progress-percentage">0%</span>
           </div>
           <div class="w-full bg-gray-200 rounded-full h-2">
            <div id="progress-bar" class="bg-gradient-to-r from-indigo-500 to-purple-500 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
           </div>
          </div><!-- Quick Tips -->
          <div class="text-center text-xs text-gray-500 max-w-md">
           <p class="mb-1">💡 <strong>Tips:</strong> Pastikan semua field sudah terisi dengan benar</p>
           <p>🎯 Template akan dipilih otomatis berdasarkan mata pelajaran yang Anda masukkan</p>
          </div>
         </div>
        </div>
       </form>
      </div>
     </div><!-- Generated Presentation Preview -->
     <div id="presentation-preview" class="hidden">
      <div class="bg-white shadow rounded-lg">
       <div class="px-4 py-5 sm:p-6">
        <div class="flex justify-between items-center mb-6">
         <h3 class="text-lg leading-6 font-medium text-gray-900">🎬 Preview Presentasi Anda</h3>
         <div class="flex space-x-3"><button id="create-new" class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg font-medium flex items-center"> ➕ Buat Presentasi Baru </button>
         </div>
        </div><!-- Slide Navigation -->
        <div class="slide-navigation bg-gray-50 rounded-lg p-4 mb-6">
         <div class="flex justify-between items-center">
          <div class="text-sm text-gray-600"><span id="slide-info">Slide 1 dari 7</span>
          </div>
          <div class="flex space-x-2"><button id="prev-slide" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded text-sm disabled:opacity-50" disabled> ← Sebelumnya </button> <button id="next-slide" class="px-3 py-1 bg-indigo-600 hover:bg-indigo-700 text-white rounded text-sm"> Selanjutnya → </button>
          </div>
         </div>
         <div class="mt-3">
          <div id="slide-dots" class="flex space-x-1"><!-- Dots will be generated dynamically -->
          </div>
         </div>
        </div><!-- Slides Container -->
        <div id="slides-container" class="space-y-6"><!-- Slides will be generated here -->
        </div><!-- Presentation Info -->
        <div class="mt-8 p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200 shadow-sm">
         <h4 class="font-bold text-blue-900 mb-4 flex items-center text-lg"><span class="mr-2 text-2xl">📋</span>Informasi Presentasi Lengkap</h4>
         <div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-sm text-blue-800">
          <div class="space-y-3">
           <div class="flex items-center p-3 bg-white rounded-lg shadow-sm"><span class="mr-3 text-lg">👨‍🏫</span>
            <div><span class="font-semibold">Penyusun:</span> <span class="ml-2 font-bold text-blue-900" id="info-penyusun"></span>
            </div>
           </div>
           <div class="flex items-center p-3 bg-white rounded-lg shadow-sm"><span class="mr-3 text-lg">📚</span>
            <div><span class="font-semibold">Mata Pelajaran:</span> <span class="ml-2 font-bold text-blue-900" id="info-mapel"></span>
            </div>
           </div>
           <div class="flex items-center p-3 bg-white rounded-lg shadow-sm"><span class="mr-3 text-lg">📐</span>
            <div><span class="font-semibold">Format:</span> <span class="ml-2 font-bold text-green-700">Presentasi Digital HD</span>
            </div>
           </div>
          </div>
          <div class="space-y-3">
           <div class="flex items-center p-3 bg-white rounded-lg shadow-sm"><span class="mr-3 text-lg">🎓</span>
            <div><span class="font-semibold">Kelas:</span> <span class="ml-2 font-bold text-blue-900" id="info-kelas"></span>
            </div>
           </div>
           <div class="flex items-center p-3 bg-white rounded-lg shadow-sm"><span class="mr-3 text-lg">📖</span>
            <div><span class="font-semibold">Topik:</span> <span class="ml-2 font-bold text-blue-900" id="info-topik"></span>
            </div>
           </div>
           <div class="flex items-center p-3 bg-white rounded-lg shadow-sm"><span class="mr-3 text-lg">📊</span>
            <div><span class="font-semibold">Total Slide:</span> <span class="ml-2 font-bold text-green-700" id="info-total-slides">10 slide</span>
            </div>
           </div>
          </div>
         </div>
         <div class="mt-6 p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg border border-green-200">
          <div class="flex items-start"><span class="mr-3 text-2xl">✨</span>
           <div>
            <h5 class="font-bold text-green-800 mb-2">Fitur Presentasi:</h5>
            <ul class="text-sm text-green-700 space-y-1">
             <li>• Konten edukatif lengkap dan terstruktur</li>
             <li>• Desain visual menarik dengan animasi</li>
             <li>• Materi disesuaikan dengan tingkat kelas</li>
             <li>• Aktivitas interaktif dan evaluasi</li>
             <li>• Siap digunakan untuk pembelajaran langsung</li>
            </ul>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
   </main><!-- Footer -->
   <footer class="bg-white border-t border-gray-200 mt-12">
    <div class="max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8">
     <p id="footer-message" class="text-center text-sm text-gray-500">© 2024 Generator Presentasi Canva - Desain Profesional Siap Pakai</p>
    </div>
   </footer>
  </div>
  <script>
        // Configuration
        const defaultConfig = {
            app_title: "Generator Presentasi Canva",
            welcome_text: "Buat presentasi Canva yang menakjubkan dalam hitungan detik",
            footer_message: "© 2024 Generator Presentasi Canva - Desain Profesional Siap Pakai",
            primary_color: "#667eea",
            secondary_color: "#764ba2",
            background_color: "#f9fafb",
            text_color: "#1f2937",
            accent_color: "#10b981"
        };

        let currentSlideIndex = 0;
        let totalSlides = 7;
        let generatedSlides = [];

        // Educational Template Configurations - Smart Subject & Topic Matching
        const templates = {
            // MATEMATIKA & SAINS EKSAK
            mathematics: {
                name: "🔢 Matematika Modern",
                description: "Desain geometris dengan elemen visual matematika",
                fontFamily: "'Inter', 'Segoe UI', system-ui, sans-serif",
                subjects: ["matematika", "aljabar", "geometri", "kalkulus", "statistika"],
                topics: ["pecahan", "persamaan", "integral", "limit", "probabilitas"],
                colors: {
                    primary: "linear-gradient(135deg, #667eea 0%, #764ba2 100%)",
                    secondary: "linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",
                    accent: "linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",
                    success: "linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)",
                    warning: "linear-gradient(135deg, #fa709a 0%, #fee140 100%)",
                    info: "linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)",
                    closing: "linear-gradient(135deg, #667eea 0%, #764ba2 100%)"
                },
                textColors: { primary: "#ffffff", secondary: "#f8f9fa", accent: "#e9ecef" },
                graphics: "🔢📐📊🧮⚡"
            },
            
            // SAINS & TEKNOLOGI
            science: {
                name: "🔬 Sains & Teknologi",
                description: "Tema futuristik dengan elemen teknologi dan laboratorium",
                fontFamily: "'Roboto', 'Arial', sans-serif",
                subjects: ["ipa", "fisika", "kimia", "biologi", "teknologi", "komputer"],
                topics: ["fotosintesis", "atom", "dna", "energi", "robot", "ai", "coding"],
                colors: {
                    primary: "linear-gradient(135deg, #0f4c75 0%, #3282b8 100%)",
                    secondary: "linear-gradient(135deg, #00d2ff 0%, #3a7bd5 100%)",
                    accent: "linear-gradient(135deg, #667eea 0%, #764ba2 100%)",
                    success: "linear-gradient(135deg, #11998e 0%, #38ef7d 100%)",
                    warning: "linear-gradient(135deg, #fc4a1a 0%, #f7b733 100%)",
                    info: "linear-gradient(135deg, #667eea 0%, #764ba2 100%)",
                    closing: "linear-gradient(135deg, #0f4c75 0%, #3282b8 100%)"
                },
                textColors: { primary: "#ffffff", secondary: "#f0f8ff", accent: "#e6f3ff" },
                graphics: "🔬⚛️🧬💻🤖"
            },
            
            // LINGKUNGAN & ALAM
            environment: {
                name: "🌱 Lingkungan & Alam",
                description: "Tema hijau natural dengan elemen alam dan sustainability",
                fontFamily: "'Nunito', 'Segoe UI', sans-serif",
                subjects: ["ipa", "biologi", "geografi", "lingkungan"],
                topics: ["fotosintesis", "ekosistem", "perubahan iklim", "konservasi", "daur ulang"],
                colors: {
                    primary: "linear-gradient(135deg, #134e5e 0%, #71b280 100%)",
                    secondary: "linear-gradient(135deg, #a8e6cf 0%, #dcedc1 100%)",
                    accent: "linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%)",
                    success: "linear-gradient(135deg, #00b09b 0%, #96c93d 100%)",
                    warning: "linear-gradient(135deg, #f7971e 0%, #ffd200 100%)",
                    info: "linear-gradient(135deg, #74b9ff 0%, #0984e3 100%)",
                    closing: "linear-gradient(135deg, #134e5e 0%, #71b280 100%)"
                },
                textColors: { primary: "#ffffff", secondary: "#f0fff0", accent: "#e8f5e8" },
                graphics: "🌱🌍♻️🌳🦋"
            },
            
            // KESEHATAN & OLAHRAGA
            health: {
                name: "💪 Kesehatan & Olahraga",
                description: "Tema energik dengan fokus kesehatan dan wellness",
                fontFamily: "'Poppins', 'Arial', sans-serif",
                subjects: ["penjaskes", "biologi", "kesehatan", "olahraga"],
                topics: ["sistem pencernaan", "sistem peredaran darah", "gizi", "mental health", "fitness"],
                colors: {
                    primary: "linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%)",
                    secondary: "linear-gradient(135deg, #ff9ff3 0%, #f368e0 100%)",
                    accent: "linear-gradient(135deg, #54a0ff 0%, #2e86de 100%)",
                    success: "linear-gradient(135deg, #5f27cd 0%, #00d2d3 100%)",
                    warning: "linear-gradient(135deg, #fd79a8 0%, #fdcb6e 100%)",
                    info: "linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%)",
                    closing: "linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%)"
                },
                textColors: { primary: "#ffffff", secondary: "#fff5f5", accent: "#ffe8e8" },
                graphics: "💪❤️🏃‍♂️🧠🥗"
            },
            
            // BAHASA & SASTRA
            language: {
                name: "📚 Bahasa & Sastra",
                description: "Tema elegan dengan elemen literatur dan komunikasi",
                fontFamily: "'Playfair Display', 'Georgia', serif",
                subjects: ["bahasa indonesia", "bahasa inggris", "sastra", "komunikasi"],
                topics: ["teks narasi", "puisi", "drama", "novel", "grammar", "writing"],
                colors: {
                    primary: "linear-gradient(135deg, #2d3436 0%, #636e72 100%)",
                    secondary: "linear-gradient(135deg, #fd79a8 0%, #fdcb6e 100%)",
                    accent: "linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%)",
                    success: "linear-gradient(135deg, #00b894 0%, #00cec9 100%)",
                    warning: "linear-gradient(135deg, #e17055 0%, #f39c12 100%)",
                    info: "linear-gradient(135deg, #74b9ff 0%, #0984e3 100%)",
                    closing: "linear-gradient(135deg, #2d3436 0%, #636e72 100%)"
                },
                textColors: { primary: "#ffffff", secondary: "#f8f9fa", accent: "#e9ecef" },
                graphics: "📚✍️📖🎭💬"
            },
            
            // SEJARAH & BUDAYA
            history: {
                name: "🏛️ Sejarah & Budaya",
                description: "Tema klasik dengan elemen heritage dan tradisi",
                fontFamily: "'Crimson Text', 'Times New Roman', serif",
                subjects: ["sejarah", "pkn", "budaya", "ips"],
                topics: ["kemerdekaan", "kerajaan", "budaya indonesia", "pahlawan", "tradisi"],
                colors: {
                    primary: "linear-gradient(135deg, #8b4513 0%, #d2691e 100%)",
                    secondary: "linear-gradient(135deg, #daa520 0%, #ffd700 100%)",
                    accent: "linear-gradient(135deg, #cd853f 0%, #f4a460 100%)",
                    success: "linear-gradient(135deg, #228b22 0%, #32cd32 100%)",
                    warning: "linear-gradient(135deg, #ff8c00 0%, #ffa500 100%)",
                    info: "linear-gradient(135deg, #4682b4 0%, #87ceeb 100%)",
                    closing: "linear-gradient(135deg, #8b4513 0%, #d2691e 100%)"
                },
                textColors: { primary: "#ffffff", secondary: "#fffaf0", accent: "#fdf5e6" },
                graphics: "🏛️👑📜🗿🎨"
            },
            
            // EKONOMI & BISNIS
            economics: {
                name: "💼 Ekonomi & Bisnis",
                description: "Tema profesional dengan elemen bisnis dan keuangan",
                fontFamily: "'Open Sans', 'Arial', sans-serif",
                subjects: ["ekonomi", "akuntansi", "bisnis", "kewirausahaan"],
                topics: ["sistem ekonomi", "pasar", "investasi", "startup", "marketing"],
                colors: {
                    primary: "linear-gradient(135deg, #1e3c72 0%, #2a5298 100%)",
                    secondary: "linear-gradient(135deg, #667eea 0%, #764ba2 100%)",
                    accent: "linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",
                    success: "linear-gradient(135deg, #00b09b 0%, #96c93d 100%)",
                    warning: "linear-gradient(135deg, #f7971e 0%, #ffd200 100%)",
                    info: "linear-gradient(135deg, #667eea 0%, #764ba2 100%)",
                    closing: "linear-gradient(135deg, #1e3c72 0%, #2a5298 100%)"
                },
                textColors: { primary: "#ffffff", secondary: "#f8f9fa", accent: "#e9ecef" },
                graphics: "💼📈💰🏢📊"
            },
            
            // SENI & KREATIVITAS
            arts: {
                name: "🎨 Seni & Kreativitas",
                description: "Tema colorful dengan elemen artistik dan kreatif",
                fontFamily: "'Quicksand', 'Arial', sans-serif",
                subjects: ["seni budaya", "musik", "tari", "rupa", "desain"],
                topics: ["lukisan", "musik tradisional", "tari daerah", "kerajinan", "desain grafis"],
                colors: {
                    primary: "linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%)",
                    secondary: "linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%)",
                    accent: "linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%)",
                    success: "linear-gradient(135deg, #8fd3f4 0%, #84fab0 100%)",
                    warning: "linear-gradient(135deg, #ffa726 0%, #ffcc02 100%)",
                    info: "linear-gradient(135deg, #667eea 0%, #764ba2 100%)",
                    closing: "linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%)"
                },
                textColors: { primary: "#ffffff", secondary: "#fff8f8", accent: "#ffeef0" },
                graphics: "🎨🎵🎭🖌️✨"
            },
            
            // GEOGRAFI & EKSPLORASI
            geography: {
                name: "🗺️ Geografi & Eksplorasi",
                description: "Tema petualangan dengan elemen peta dan eksplorasi",
                fontFamily: "'Montserrat', 'Arial', sans-serif",
                subjects: ["geografi", "ips", "eksplorasi", "travel"],
                topics: ["benua", "negara", "iklim", "peta", "budaya dunia", "globalisasi"],
                colors: {
                    primary: "linear-gradient(135deg, #2980b9 0%, #6bb6ff 100%)",
                    secondary: "linear-gradient(135deg, #74b9ff 0%, #0984e3 100%)",
                    accent: "linear-gradient(135deg, #00cec9 0%, #55a3ff 100%)",
                    success: "linear-gradient(135deg, #00b894 0%, #00cec9 100%)",
                    warning: "linear-gradient(135deg, #fdcb6e 0%, #e17055 100%)",
                    info: "linear-gradient(135deg, #a29bfe 0%, #6c5ce7 100%)",
                    closing: "linear-gradient(135deg, #2980b9 0%, #6bb6ff 100%)"
                },
                textColors: { primary: "#ffffff", secondary: "#f0f8ff", accent: "#e6f3ff" },
                graphics: "🗺️🌍✈️🧭🏔️"
            },
            
            // TEKNOLOGI & AI
            technology: {
                name: "🤖 Teknologi & AI",
                description: "Tema futuristik dengan elemen AI dan digital",
                fontFamily: "'Orbitron', 'Arial', sans-serif",
                subjects: ["teknologi", "informatika", "ai", "robotika", "digital"],
                topics: ["artificial intelligence", "machine learning", "robotika", "coding", "digital transformation"],
                colors: {
                    primary: "linear-gradient(135deg, #0f0f23 0%, #262626 100%)",
                    secondary: "linear-gradient(135deg, #667eea 0%, #764ba2 100%)",
                    accent: "linear-gradient(135deg, #00d2ff 0%, #3a7bd5 100%)",
                    success: "linear-gradient(135deg, #11998e 0%, #38ef7d 100%)",
                    warning: "linear-gradient(135deg, #fc4a1a 0%, #f7b733 100%)",
                    info: "linear-gradient(135deg, #667eea 0%, #764ba2 100%)",
                    closing: "linear-gradient(135deg, #0f0f23 0%, #262626 100%)"
                },
                textColors: { primary: "#ffffff", secondary: "#f0f8ff", accent: "#e6f3ff" },
                graphics: "🤖💻⚡🔮🚀"
            }
        };

        // Initialize SDK
        async function initializeApp() {
            if (window.elementSdk) {
                await window.elementSdk.init({
                    defaultConfig,
                    render,
                    mapToCapabilities,
                    mapToEditPanelValues
                });
            }

            setupEventListeners();
            setupAIThemeRecommendation();
        }

        // Render function for element SDK
        async function render(config) {
            const appTitle = config.app_title || defaultConfig.app_title;
            const welcomeText = config.welcome_text || defaultConfig.welcome_text;
            const footerMessage = config.footer_message || defaultConfig.footer_message;
            const primaryColor = config.primary_color || defaultConfig.primary_color;
            const backgroundColor = config.background_color || defaultConfig.background_color;
            const textColor = config.text_color || defaultConfig.text_color;

            document.getElementById('app-title').textContent = appTitle;
            document.getElementById('welcome-text').textContent = welcomeText;
            document.getElementById('footer-message').textContent = footerMessage;

            // Apply colors
            document.body.style.backgroundColor = backgroundColor;
            document.body.style.color = textColor;
            
            const header = document.querySelector('header');
            if (header) {
                header.style.background = `linear-gradient(135deg, ${primaryColor} 0%, ${config.secondary_color || defaultConfig.secondary_color} 100%)`;
            }
        }

        // Capabilities mapping
        function mapToCapabilities(config) {
            return {
                recolorables: [
                    {
                        get: () => config.primary_color || defaultConfig.primary_color,
                        set: (value) => {
                            if (window.elementSdk) {
                                window.elementSdk.setConfig({ primary_color: value });
                            }
                        }
                    },
                    {
                        get: () => config.background_color || defaultConfig.background_color,
                        set: (value) => {
                            if (window.elementSdk) {
                                window.elementSdk.setConfig({ background_color: value });
                            }
                        }
                    },
                    {
                        get: () => config.text_color || defaultConfig.text_color,
                        set: (value) => {
                            if (window.elementSdk) {
                                window.elementSdk.setConfig({ text_color: value });
                            }
                        }
                    }
                ],
                borderables: [],
                fontEditable: undefined,
                fontSizeable: undefined
            };
        }

        // Edit panel values mapping
        function mapToEditPanelValues(config) {
            return new Map([
                ["app_title", config.app_title || defaultConfig.app_title],
                ["welcome_text", config.welcome_text || defaultConfig.welcome_text],
                ["footer_message", config.footer_message || defaultConfig.footer_message]
            ]);
        }

        // Setup event listeners
        function setupEventListeners() {
            const form = document.getElementById('presentation-form');
            const createNewBtn = document.getElementById('create-new');
            const prevBtn = document.getElementById('prev-slide');
            const nextBtn = document.getElementById('next-slide');

            form.addEventListener('submit', handleFormSubmit);
            
            if (createNewBtn) {
                createNewBtn.addEventListener('click', resetForm);
            }
            
            if (prevBtn) {
                prevBtn.addEventListener('click', () => navigateSlide(-1));
            }
            
            if (nextBtn) {
                nextBtn.addEventListener('click', () => navigateSlide(1));
            }
        }

        // Smart Template Selection System
        function setupTemplateSelection() {
            const templateCards = document.querySelectorAll('.template-card');
            const radioInputs = document.querySelectorAll('input[name="template"]');
            const mataPelajaranInput = document.getElementById('mata_pelajaran');
            const topikMateriInput = document.getElementById('topik_materi');
            const autoTemplateDisplay = document.getElementById('auto-template-display');
            const selectedTemplateName = document.getElementById('selected-template-name');
            const selectedTemplateDesc = document.getElementById('selected-template-desc');

            // Auto-select template based on subject and topic
            function autoSelectTemplate() {
                const mataPelajaran = mataPelajaranInput.value.toLowerCase().trim();
                const topikMateri = topikMateriInput.value.toLowerCase().trim();
                
                if (!mataPelajaran && !topikMateri) {
                    autoTemplateDisplay.classList.add('hidden');
                    return;
                }

                let bestMatch = null;
                let bestScore = 0;

                // Find best matching template
                for (const [templateKey, template] of Object.entries(templates)) {
                    let score = 0;
                    
                    // Check subject match
                    template.subjects.forEach(subject => {
                        if (mataPelajaran.includes(subject) || subject.includes(mataPelajaran)) {
                            score += 10;
                        }
                    });
                    
                    // Check topic match
                    template.topics.forEach(topic => {
                        if (topikMateri.includes(topic) || topic.includes(topikMateri)) {
                            score += 8;
                        }
                    });
                    
                    // Partial matches
                    if (mataPelajaran.includes('matematika') || mataPelajaran.includes('math')) {
                        if (templateKey === 'mathematics') score += 15;
                    }
                    if (mataPelajaran.includes('ipa') || mataPelajaran.includes('sains') || mataPelajaran.includes('science')) {
                        if (templateKey === 'science') score += 15;
                    }
                    if (mataPelajaran.includes('bahasa') || mataPelajaran.includes('sastra')) {
                        if (templateKey === 'language') score += 15;
                    }
                    if (mataPelajaran.includes('sejarah') || mataPelajaran.includes('pkn')) {
                        if (templateKey === 'history') score += 15;
                    }
                    if (mataPelajaran.includes('ekonomi') || mataPelajaran.includes('bisnis')) {
                        if (templateKey === 'economics') score += 15;
                    }
                    if (mataPelajaran.includes('seni') || mataPelajaran.includes('musik') || mataPelajaran.includes('tari')) {
                        if (templateKey === 'arts') score += 15;
                    }
                    if (mataPelajaran.includes('geografi') || mataPelajaran.includes('ips')) {
                        if (templateKey === 'geography') score += 15;
                    }
                    if (mataPelajaran.includes('teknologi') || mataPelajaran.includes('komputer') || mataPelajaran.includes('informatika')) {
                        if (templateKey === 'technology') score += 15;
                    }
                    if (mataPelajaran.includes('olahraga') || mataPelajaran.includes('kesehatan') || mataPelajaran.includes('biologi')) {
                        if (templateKey === 'health') score += 15;
                    }
                    
                    // Topic-based matching
                    if (topikMateri.includes('ai') || topikMateri.includes('artificial intelligence') || topikMateri.includes('robot')) {
                        if (templateKey === 'technology') score += 20;
                    }
                    if (topikMateri.includes('lingkungan') || topikMateri.includes('iklim') || topikMateri.includes('fotosintesis')) {
                        if (templateKey === 'environment') score += 20;
                    }
                    if (topikMateri.includes('kesehatan mental') || topikMateri.includes('sistem pencernaan') || topikMateri.includes('sistem peredaran')) {
                        if (templateKey === 'health') score += 20;
                    }
                    
                    if (score > bestScore) {
                        bestScore = score;
                        bestMatch = { key: templateKey, template: template };
                    }
                }

                // Auto-select if good match found
                if (bestMatch && bestScore >= 8) {
                    const templateRadio = document.querySelector(`input[name="template"][value="${bestMatch.key}"]`);
                    if (templateRadio) {
                        templateRadio.checked = true;
                        templateRadio.dispatchEvent(new Event('change'));
                        
                        // Show auto-selection display
                        selectedTemplateName.textContent = bestMatch.template.name;
                        selectedTemplateDesc.textContent = bestMatch.template.description;
                        autoTemplateDisplay.classList.remove('hidden');
                    }
                } else {
                    // Default to mathematics if no good match
                    const defaultRadio = document.querySelector(`input[name="template"][value="mathematics"]`);
                    if (defaultRadio) {
                        defaultRadio.checked = true;
                        defaultRadio.dispatchEvent(new Event('change'));
                    }
                    autoTemplateDisplay.classList.add('hidden');
                }
            }

            // Manual template selection
            radioInputs.forEach((radio, index) => {
                radio.addEventListener('change', () => {
                    templateCards.forEach(card => {
                        card.classList.remove('border-indigo-500');
                        card.classList.add('border-gray-300');
                    });
                    
                    if (radio.checked) {
                        templateCards[index].classList.remove('border-gray-300');
                        templateCards[index].classList.add('border-indigo-500');
                        
                        // Hide auto-selection when manually selected
                        if (radio.value !== getAutoSelectedTemplate()) {
                            autoTemplateDisplay.classList.add('hidden');
                        }
                    }
                });
            });

            // Listen for input changes to trigger auto-selection
            mataPelajaranInput.addEventListener('input', debounce(autoSelectTemplate, 500));
            topikMateriInput.addEventListener('input', debounce(autoSelectTemplate, 500));
            
            // Initial auto-selection
            setTimeout(autoSelectTemplate, 100);
        }

        // Setup AI theme recommendation
        function setupAIThemeRecommendation() {
            const mataPelajaranInput = document.getElementById('mata_pelajaran');
            const topikMateriInput = document.getElementById('topik_materi');
            const kelasInput = document.getElementById('kelas_fase');
            const aiRecommendationDisplay = document.getElementById('ai-recommendation-display');
            const selectedThemeDisplay = document.getElementById('selected-theme-display');
            const selectedThemeIcon = document.getElementById('selected-theme-icon');
            const selectedThemeName = document.getElementById('selected-theme-name');
            const selectedThemeDesc = document.getElementById('selected-theme-desc');
            const selectedThemeFeatures = document.getElementById('selected-theme-features');

            // AI theme recommendation based on learning context
            function recommendThemeWithAI() {
                const mataPelajaran = mataPelajaranInput.value.toLowerCase().trim();
                const topikMateri = topikMateriInput.value.toLowerCase().trim();
                const kelas = kelasInput.value.toLowerCase().trim();
                
                if (!mataPelajaran && !topikMateri) {
                    // Hide recommendation if no input
                    selectedThemeDisplay.classList.add('hidden');
                    return;
                }

                // Show AI analysis animation
                selectedThemeDisplay.classList.add('hidden');
                
                // Simulate AI processing delay
                setTimeout(() => {
                    const recommendedTheme = getAIRecommendedTheme(mataPelajaran, topikMateri, kelas);
                    
                    if (recommendedTheme) {
                        // Update display with AI recommendation
                        selectedThemeIcon.textContent = recommendedTheme.icon;
                        selectedThemeName.textContent = recommendedTheme.name;
                        selectedThemeDesc.textContent = recommendedTheme.description;
                        selectedThemeFeatures.textContent = recommendedTheme.features;
                        
                        // Show the recommendation
                        selectedThemeDisplay.classList.remove('hidden');
                        
                        // Store selected theme for generation
                        window.selectedAITheme = recommendedTheme.key;
                    }
                }, 800); // Simulate AI processing time
            }

            // Advanced AI algorithm for theme recommendation
            function getAIRecommendedTheme(mataPelajaran, topikMateri, kelas) {
                let bestMatch = null;
                let bestScore = 0;
                let matchingFactors = [];

                // Enhanced AI scoring system
                for (const [templateKey, template] of Object.entries(templates)) {
                    let score = 0;
                    let factors = [];
                    
                    // Subject-based scoring (40% weight)
                    template.subjects.forEach(subject => {
                        if (mataPelajaran.includes(subject) || subject.includes(mataPelajaran)) {
                            score += 40;
                            factors.push(`Mata pelajaran: ${subject}`);
                        }
                    });
                    
                    // Topic-based scoring (35% weight)
                    template.topics.forEach(topic => {
                        if (topikMateri.includes(topic) || topic.includes(topikMateri)) {
                            score += 35;
                            factors.push(`Topik: ${topic}`);
                        }
                    });
                    
                    // Advanced pattern matching (25% weight)
                    const advancedMatches = getAdvancedMatches(mataPelajaran, topikMateri, templateKey);
                    score += advancedMatches.score;
                    factors = factors.concat(advancedMatches.factors);
                    
                    if (score > bestScore) {
                        bestScore = score;
                        bestMatch = { 
                            key: templateKey, 
                            template: template,
                            score: score,
                            factors: factors
                        };
                    }
                }

                // Return best match if score is sufficient
                if (bestMatch && bestScore >= 25) {
                    return {
                        key: bestMatch.key,
                        name: bestMatch.template.name,
                        description: bestMatch.template.description,
                        icon: getTemplateIcon(bestMatch.key),
                        features: bestMatch.factors.slice(0, 2).join(' • '),
                        score: bestMatch.score
                    };
                }

                // Default fallback
                return {
                    key: 'mathematics',
                    name: '🔢 Matematika Modern',
                    description: 'Tema universal dengan desain geometris yang cocok untuk berbagai pembelajaran',
                    icon: '🔢',
                    features: 'Desain universal • Mudah dibaca',
                    score: 100
                };
            }

            // Advanced pattern matching for more accurate recommendations
            function getAdvancedMatches(mataPelajaran, topikMateri, templateKey) {
                let score = 0;
                let factors = [];
                
                // Science and STEM subjects
                if ((mataPelajaran.includes('ipa') || mataPelajaran.includes('sains') || 
                     mataPelajaran.includes('fisika') || mataPelajaran.includes('kimia') || 
                     mataPelajaran.includes('biologi')) && templateKey === 'science') {
                    score += 25;
                    factors.push('STEM/Sains');
                }
                
                // Mathematics and exact sciences
                if ((mataPelajaran.includes('matematika') || mataPelajaran.includes('aljabar') || 
                     mataPelajaran.includes('geometri') || mataPelajaran.includes('statistik')) && 
                     templateKey === 'mathematics') {
                    score += 25;
                    factors.push('Matematika/Eksak');
                }
                
                // Language and literature
                if ((mataPelajaran.includes('bahasa') || mataPelajaran.includes('sastra') || 
                     mataPelajaran.includes('komunikasi')) && templateKey === 'language') {
                    score += 25;
                    factors.push('Bahasa/Sastra');
                }
                
                // Social studies
                if ((mataPelajaran.includes('sejarah') || mataPelajaran.includes('pkn') || 
                     mataPelajaran.includes('ips')) && templateKey === 'history') {
                    score += 25;
                    factors.push('Sosial/Sejarah');
                }
                
                // Arts and creativity
                if ((mataPelajaran.includes('seni') || mataPelajaran.includes('musik') || 
                     mataPelajaran.includes('tari') || mataPelajaran.includes('rupa')) && 
                     templateKey === 'arts') {
                    score += 25;
                    factors.push('Seni/Kreativitas');
                }
                
                // Geography and exploration
                if ((mataPelajaran.includes('geografi') || topikMateri.includes('peta') || 
                     topikMateri.includes('benua') || topikMateri.includes('iklim')) && 
                     templateKey === 'geography') {
                    score += 25;
                    factors.push('Geografi/Eksplorasi');
                }
                
                // Technology and computing
                if ((mataPelajaran.includes('teknologi') || mataPelajaran.includes('komputer') || 
                     mataPelajaran.includes('informatika') || topikMateri.includes('ai') || 
                     topikMateri.includes('robot')) && templateKey === 'technology') {
                    score += 25;
                    factors.push('Teknologi/AI');
                }
                
                // Health and sports
                if ((mataPelajaran.includes('olahraga') || mataPelajaran.includes('kesehatan') || 
                     mataPelajaran.includes('penjaskes') || topikMateri.includes('sistem pencernaan') || 
                     topikMateri.includes('sistem peredaran')) && templateKey === 'health') {
                    score += 25;
                    factors.push('Kesehatan/Olahraga');
                }
                
                // Environment and nature
                if ((topikMateri.includes('lingkungan') || topikMateri.includes('fotosintesis') || 
                     topikMateri.includes('ekosistem') || topikMateri.includes('iklim')) && 
                     templateKey === 'environment') {
                    score += 25;
                    factors.push('Lingkungan/Alam');
                }
                
                // Economics and business
                if ((mataPelajaran.includes('ekonomi') || mataPelajaran.includes('bisnis') || 
                     mataPelajaran.includes('akuntansi') || topikMateri.includes('pasar') || 
                     topikMateri.includes('investasi')) && templateKey === 'economics') {
                    score += 25;
                    factors.push('Ekonomi/Bisnis');
                }
                
                return { score, factors };
            }

            // Get icon for template
            function getTemplateIcon(templateKey) {
                const icons = {
                    mathematics: '🔢',
                    science: '🔬',
                    environment: '🌱',
                    health: '💪',
                    language: '📚',
                    history: '🏛️',
                    economics: '💼',
                    arts: '🎨',
                    geography: '🗺️',
                    technology: '🤖'
                };
                return icons[templateKey] || '📖';
            }

            // Listen for input changes to trigger AI recommendation
            mataPelajaranInput.addEventListener('input', debounce(recommendThemeWithAI, 600));
            topikMateriInput.addEventListener('input', debounce(recommendThemeWithAI, 600));
            kelasInput.addEventListener('change', debounce(recommendThemeWithAI, 300));
            
            // Initial recommendation
            setTimeout(recommendThemeWithAI, 200);
        }

        // Debounce function to limit API calls
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Handle form submission with enhanced progress
        async function handleFormSubmit(event) {
            event.preventDefault();
            
            const generateBtn = document.getElementById('generate-btn');
            const generateText = document.getElementById('generate-text');
            const generateSpinner = document.getElementById('generate-spinner');
            const progressContainer = document.getElementById('generation-progress');
            const progressBar = document.getElementById('progress-bar');
            const progressText = document.getElementById('progress-text');
            const progressPercentage = document.getElementById('progress-percentage');

            // Show loading state
            generateBtn.disabled = true;
            generateSpinner.classList.remove('hidden');
            progressContainer.classList.remove('hidden');

            try {
                const formData = new FormData(event.target);
                
                // Enhanced progress simulation with real-time updates
                const progressSteps = [
                    { text: "🔍 Menganalisis mata pelajaran dan topik...", percentage: 12, delay: 400 },
                    { text: "🎯 Menentukan struktur pembelajaran...", percentage: 25, delay: 500 },
                    { text: "🤖 Memilih template optimal berdasarkan AI...", percentage: 38, delay: 600 },
                    { text: "📝 Menghasilkan konten edukatif mendalam...", percentage: 52, delay: 800 },
                    { text: "🎨 Mendesain slide dengan elemen visual...", percentage: 68, delay: 700 },
                    { text: "✨ Menambahkan animasi dan interaksi...", percentage: 82, delay: 500 },
                    { text: "🔧 Mengoptimalkan layout dan tipografi...", percentage: 94, delay: 400 },
                    { text: "🚀 Finalisasi presentasi siap pakai...", percentage: 100, delay: 300 }
                ];

                for (const step of progressSteps) {
                    progressText.textContent = step.text;
                    progressPercentage.textContent = `${step.percentage}%`;
                    progressBar.style.width = `${step.percentage}%`;
                    
                    // Dynamic button text updates
                    if (step.percentage <= 25) {
                        generateText.innerHTML = '<span class="mr-3 text-2xl animate-spin">🔍</span>Menganalisis Data...';
                    } else if (step.percentage <= 50) {
                        generateText.innerHTML = '<span class="mr-3 text-2xl animate-bounce">🤖</span>Membuat Konten AI...';
                    } else if (step.percentage <= 80) {
                        generateText.innerHTML = '<span class="mr-3 text-2xl animate-pulse">🎨</span>Mendesain Slide...';
                    } else {
                        generateText.innerHTML = '<span class="mr-3 text-2xl animate-ping">🚀</span>Menyelesaikan...';
                    }
                    
                    await new Promise(resolve => setTimeout(resolve, step.delay));
                }
                
                // Generate presentation immediately after progress
                generatePresentation(formData);
                
                showPresentationComplete();
                
            } catch (error) {
                showToast("❌ Terjadi kesalahan. Silakan periksa data dan coba lagi.", "error");
            } finally {
                // Reset loading state
                generateBtn.disabled = false;
                generateText.innerHTML = '<span class="mr-3 text-2xl">🚀</span>Generate Presentasi Canva';
                generateSpinner.classList.add('hidden');
                progressContainer.classList.add('hidden');
                
                // Reset progress
                progressBar.style.width = '0%';
                progressText.textContent = 'Memproses data...';
                progressPercentage.textContent = '0%';
            }
        }



        // Generate presentation with AI-powered content
        function generatePresentation(formData) {
            const selectedTemplate = window.selectedAITheme || 'mathematics';
            const template = templates[selectedTemplate];
            
            // Generate detailed content using AI
            const aiContent = generateDetailedContent(
                formData.get('topik_materi'),
                formData.get('mata_pelajaran'),
                formData.get('kelas_fase')
            );
            
            generatedSlides = [
                {
                    type: 'title',
                    title: formData.get('mata_pelajaran'),
                    subtitle: formData.get('topik_materi'),
                    author: formData.get('penyusun'),
                    class: formData.get('kelas_fase'),
                    background: template.colors.primary,
                    icon: getSubjectIcon(formData.get('mata_pelajaran')),
                    date: new Date().toLocaleDateString('id-ID', { 
                        weekday: 'long', 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric' 
                    })
                },
                {
                    type: 'agenda',
                    title: '📋 Agenda Pembelajaran Hari Ini',
                    content: generateAgendaContent(aiContent),
                    background: template.colors.secondary,
                    icon: '📋'
                },
                {
                    type: 'objectives',
                    title: '🎯 Tujuan Pembelajaran',
                    content: aiContent.tujuan,
                    background: template.colors.accent,
                    icon: '🎯'
                },
                {
                    type: 'introduction',
                    title: '📖 Pengenalan Topik',
                    content: aiContent.pengenalan,
                    background: template.colors.success,
                    icon: '📖'
                },
                {
                    type: 'theory',
                    title: '🧠 Materi Inti & Teori',
                    content: aiContent.teori,
                    background: template.colors.warning,
                    icon: '🧠'
                },
                {
                    type: 'examples',
                    title: '🌍 Aplikasi dalam Kehidupan',
                    content: aiContent.contohKehidupan,
                    background: template.colors.info,
                    icon: '🌍'
                },
                {
                    type: 'practice',
                    title: '🎯 Aktivitas & Praktik Langsung',
                    content: aiContent.latihanPraktik,
                    background: template.colors.accent,
                    icon: '🎯'
                },
                {
                    type: 'assessment',
                    title: '✅ Evaluasi & Penilaian',
                    content: generateAssessmentContent(formData.get('topik_materi'), formData.get('mata_pelajaran')),
                    background: template.colors.warning,
                    icon: '✅'
                },
                {
                    type: 'summary',
                    title: '📝 Rangkuman Pembelajaran',
                    content: generateSummaryContent(formData.get('topik_materi'), formData.get('mata_pelajaran')),
                    background: template.colors.info,
                    icon: '📝'
                },
                {
                    type: 'closing',
                    title: generateClosingTitle(formData.get('topik_materi')),
                    subtitle: generateClosingMessage(formData.get('topik_materi'), formData.get('mata_pelajaran')),
                    footer: `${formData.get('penyusun')} | ${formData.get('mata_pelajaran')} | ${formData.get('kelas_fase')} | ${new Date().getFullYear()}`,
                    background: template.colors.closing,
                    icon: '🎉'
                }
            ];

            // Update presentation info
            document.getElementById('info-penyusun').textContent = formData.get('penyusun');
            document.getElementById('info-mapel').textContent = formData.get('mata_pelajaran');
            document.getElementById('info-kelas').textContent = formData.get('kelas_fase');
            document.getElementById('info-topik').textContent = formData.get('topik_materi');
            document.getElementById('info-total-slides').textContent = `${generatedSlides.length} slide`;

            renderSlides();
            showPreview();
            currentSlideIndex = 0;
            totalSlides = generatedSlides.length;
            updateSlideNavigation();
            
            // Update slide info in navigation
            document.getElementById('slide-info').textContent = `Slide 1 dari ${totalSlides}`;
        }

        // Render slides with professional styling and animations
        function renderSlides() {
            const container = document.getElementById('slides-container');
            const selectedTemplate = document.querySelector('input[name="template"]:checked')?.value || 'modern';
            const template = templates[selectedTemplate];
            
            container.innerHTML = generatedSlides.map((slide, index) => {
                const fontFamily = template.fontFamily;
                const textColor = template.textColors?.primary || '#ffffff';
                
                if (slide.type === 'title') {
                    return `
                        <div class="slide-preview fade-in" style="background: ${slide.background}; color: ${textColor}; font-family: ${fontFamily};" data-slide="${index}" ${index === 0 ? '' : 'style="display: none;"'}>
                            ${getEducationalBackground(selectedTemplate)}
                            <div class="absolute top-8 right-8 text-sm opacity-75 bg-black bg-opacity-20 px-3 py-1 rounded-full slide-in-right">
                                ${slide.date || ''}
                            </div>
                            <div class="text-center h-full flex flex-col justify-center px-12 relative z-10">
                                <div class="text-8xl mb-8 drop-shadow-lg bounce-animation floating-animation">${slide.icon}</div>
                                <h1 class="text-6xl font-bold mb-8 leading-tight drop-shadow-md zoom-in">${slide.title}</h1>
                                <h2 class="text-4xl mb-16 opacity-95 font-medium leading-relaxed slide-in-left">${slide.subtitle}</h2>
                                <div class="mt-20 space-y-4 text-2xl">
                                    <div class="bg-white bg-opacity-15 backdrop-blur-sm rounded-2xl p-6 mx-auto max-w-2xl pulse-glow">
                                        <p class="flex items-center justify-center mb-3 slide-in-left"><span class="mr-4 text-3xl heartbeat">👨‍🏫</span><span class="font-semibold">${slide.author}</span></p>
                                        <p class="flex items-center justify-center slide-in-right"><span class="mr-4 text-3xl bounce-animation">🎓</span><span class="font-semibold">${slide.class}</span></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                } else if (slide.type === 'agenda') {
                    return `
                        <div class="slide-preview fade-in" style="background: ${slide.background}; color: ${textColor}; font-family: ${fontFamily};" data-slide="${index}" ${index === 0 ? '' : 'style="display: none;"'}>
                            ${getEducationalBackground(selectedTemplate)}
                            <div class="h-full flex flex-col p-12 relative z-10">
                                <div class="text-center mb-10">
                                    <div class="text-7xl mb-6 drop-shadow-lg rotate-animation">${slide.icon}</div>
                                    <h2 class="text-5xl font-bold drop-shadow-md typewriter">${slide.title}</h2>
                                    <div class="w-32 h-1 bg-white bg-opacity-50 mx-auto mt-4 rounded-full pulse-glow"></div>
                                </div>
                                <div class="flex-1 text-left text-lg leading-relaxed space-y-3 max-w-6xl mx-auto overflow-y-auto">
                                    ${slide.content.split('\n').map((line, lineIndex) => {
                                        if (line.trim() === '') return '';
                                        const animationDelay = `style="animation-delay: ${lineIndex * 0.2}s"`;
                                        if (line.includes('⏰') || line.includes('📖') || line.includes('✅')) {
                                            return `<div class="bg-white bg-opacity-20 backdrop-blur-sm rounded-xl p-4 mt-8 mb-4 slide-in-left pulse-glow" ${animationDelay}>
                                                <h3 class="text-2xl font-bold text-yellow-200 flex items-center">
                                                    <span class="mr-3 bounce-animation">${line.match(/[⏰📖✅]/)?.[0] || ''}</span>
                                                    <span>${line.replace(/[⏰📖✅]/g, '').trim()}</span>
                                                </h3>
                                            </div>`;
                                        }
                                        if (line.startsWith('• ')) {
                                            return `<div class="flex items-start ml-6 py-1 slide-in-right" ${animationDelay}>
                                                <span class="mr-4 text-yellow-300 text-xl font-bold floating-animation">•</span>
                                                <span class="text-lg">${line.replace('• ', '')}</span>
                                            </div>`;
                                        }
                                        if (line.includes('🎯 METODE:')) {
                                            return `<div class="mt-8 p-6 bg-gradient-to-r from-white/20 to-white/10 backdrop-blur-sm rounded-2xl border border-white/20 zoom-in pulse-glow" ${animationDelay}>
                                                <p class="font-bold text-xl text-yellow-100">${line}</p>
                                            </div>`;
                                        }
                                        return `<p class="text-xl font-medium opacity-95 leading-relaxed slide-in-left" ${animationDelay}>${line}</p>`;
                                    }).join('')}
                                </div>
                            </div>
                        </div>
                    `;
                } else if (slide.type === 'objectives' || slide.type === 'introduction' || slide.type === 'theory' || slide.type === 'examples' || slide.type === 'practice') {
                    return `
                        <div class="slide-preview fade-in" style="background: ${slide.background}; color: white;" data-slide="${index}" ${index === 0 ? '' : 'style="display: none;"'}>
                            ${getEducationalBackground(selectedTemplate)}
                            <div class="h-full flex flex-col relative z-10">
                                <div class="text-center mb-8">
                                    <div class="text-6xl mb-4 floating-animation">${slide.icon}</div>
                                    <h2 class="text-4xl font-bold zoom-in">${slide.title}</h2>
                                    <div class="w-24 h-1 bg-white bg-opacity-50 mx-auto mt-3 rounded-full pulse-glow"></div>
                                </div>
                                <div class="flex-1 text-left text-lg leading-relaxed space-y-3 max-w-5xl mx-auto overflow-y-auto">
                                    ${slide.content.split('\n').map((line, lineIndex) => {
                                        if (line.trim() === '') return '';
                                        const animationDelay = `style="animation-delay: ${lineIndex * 0.15}s"`;
                                        if (line.startsWith('• ')) {
                                            return `<p class="flex items-start slide-in-left" ${animationDelay}><span class="mr-3 text-yellow-300 font-bold bounce-animation">•</span><span>${line.replace('• ', '')}</span></p>`;
                                        }
                                        if (line.includes('🔸') || line.includes('🔹') || line.includes('📍') || line.includes('⏰') || line.includes('👥') || line.includes('❓') || line.includes('🔧')) {
                                            return `<h3 class="text-2xl font-bold mt-6 mb-3 text-yellow-200 slide-in-right pulse-glow" ${animationDelay}>${line}</h3>`;
                                        }
                                        if (line.includes(':') && !line.startsWith('• ')) {
                                            return `<h4 class="text-xl font-semibold mt-4 mb-2 text-yellow-100 slide-in-left" ${animationDelay}>${line}</h4>`;
                                        }
                                        return `<p class="text-lg slide-in-left" ${animationDelay}>${line}</p>`;
                                    }).join('')}
                                </div>
                            </div>
                        </div>
                    `;
                } else if (slide.type === 'assessment' || slide.type === 'summary') {
                    return renderAssessmentSlide(slide, index, template, textColor, fontFamily, selectedTemplate);
                } else if (slide.type === 'closing') {
                    return `
                        <div class="slide-preview fade-in" style="background: ${slide.background}; color: #2d3748; font-family: ${fontFamily};" data-slide="${index}" ${index === 0 ? '' : 'style="display: none;"'}>
                            ${getEducationalBackground(selectedTemplate)}
                            <div class="text-center h-full flex flex-col justify-center px-12 py-8 relative z-10">
                                <div class="text-9xl mb-8 drop-shadow-xl pulse floating-animation">${slide.icon}</div>
                                <h1 class="text-5xl font-bold mb-10 leading-tight drop-shadow-lg text-gray-800 zoom-in">${slide.title}</h1>
                                <div class="text-lg mb-12 leading-relaxed max-w-5xl mx-auto overflow-y-auto">
                                    ${slide.subtitle.split('\n').map((line, lineIndex) => {
                                        if (line.trim() === '') return '<div class="h-3"></div>';
                                        const animationDelay = `style="animation-delay: ${lineIndex * 0.1}s"`;
                                        if (line.includes('🌟') || line.includes('💪') || line.includes('🚀') || line.includes('🏗️') || line.includes('🌱') || line.includes('🎯') || line.includes('💝') || line.includes('🌈')) {
                                            return `<div class="bg-gradient-to-r from-blue-100 to-purple-100 rounded-2xl p-6 mt-8 mb-6 shadow-lg border border-blue-200 zoom-in pulse-glow" ${animationDelay}>
                                                <h3 class="text-2xl font-bold text-blue-800 mb-3">${line}</h3>
                                            </div>`;
                                        }
                                        if (line.startsWith('• ')) {
                                            return `<div class="flex items-start justify-center max-w-4xl mx-auto mb-2 slide-in-left" ${animationDelay}>
                                                <span class="mr-3 text-blue-600 font-bold text-xl bounce-animation">•</span>
                                                <span class="text-left text-gray-700">${line.replace('• ', '')}</span>
                                            </div>`;
                                        }
                                        if (line.startsWith('"') && line.endsWith('"')) {
                                            return `<div class="bg-gradient-to-r from-yellow-50 to-orange-50 rounded-2xl p-6 my-6 border-l-6 border-yellow-400 shadow-md slide-in-right pulse-glow" ${animationDelay}>
                                                <p class="italic text-xl font-medium text-gray-800 leading-relaxed">${line}</p>
                                            </div>`;
                                        }
                                        if (line.includes('📚') || line.includes('🔬') || line.includes('🌐')) {
                                            return `<div class="bg-white bg-opacity-80 rounded-xl p-4 mt-6 mb-4 shadow-md border border-gray-200 slide-in-left" ${animationDelay}>
                                                <h4 class="text-lg font-semibold text-gray-800 mb-2">${line}</h4>
                                            </div>`;
                                        }
                                        return `<p class="mb-3 text-gray-700 leading-relaxed max-w-4xl mx-auto slide-in-left" ${animationDelay}>${line}</p>`;
                                    }).join('')}
                                </div>
                                <div class="mt-auto pt-6 border-t border-gray-300">
                                    <p class="text-sm text-gray-600 font-medium bg-white bg-opacity-70 rounded-full px-6 py-2 inline-block shadow-sm pulse-glow">${slide.footer}</p>
                                </div>
                            </div>
                        </div>
                    `;
                }
            }).join('');
        }

        // Show preview section
        function showPreview() {
            const previewSection = document.getElementById('presentation-preview');
            previewSection.classList.remove('hidden');
            previewSection.scrollIntoView({ behavior: 'smooth' });
        }

        // Navigate slides
        function navigateSlide(direction) {
            const newIndex = currentSlideIndex + direction;
            
            if (newIndex >= 0 && newIndex < totalSlides) {
                // Hide current slide
                const currentSlide = document.querySelector(`[data-slide="${currentSlideIndex}"]`);
                if (currentSlide) {
                    currentSlide.style.display = 'none';
                }
                
                // Show new slide
                const newSlide = document.querySelector(`[data-slide="${newIndex}"]`);
                if (newSlide) {
                    newSlide.style.display = 'flex';
                    newSlide.classList.add('fade-in');
                }
                
                currentSlideIndex = newIndex;
                updateSlideNavigation();
            }
        }

        // Update slide navigation
        function updateSlideNavigation() {
            const slideInfo = document.getElementById('slide-info');
            const prevBtn = document.getElementById('prev-slide');
            const nextBtn = document.getElementById('next-slide');
            const dotsContainer = document.getElementById('slide-dots');

            slideInfo.textContent = `Slide ${currentSlideIndex + 1} dari ${totalSlides}`;
            
            prevBtn.disabled = currentSlideIndex === 0;
            nextBtn.disabled = currentSlideIndex === totalSlides - 1;
            
            // Generate dots dynamically
            if (dotsContainer) {
                dotsContainer.innerHTML = '';
                for (let i = 0; i < totalSlides; i++) {
                    const dot = document.createElement('div');
                    dot.className = `slide-dot w-3 h-3 rounded-full cursor-pointer transition-colors ${
                        i === currentSlideIndex ? 'bg-indigo-600' : 'bg-gray-300'
                    }`;
                    dot.addEventListener('click', () => {
                        navigateToSlide(i);
                    });
                    dotsContainer.appendChild(dot);
                }
            }
        }

        // Navigate to specific slide
        function navigateToSlide(targetIndex) {
            if (targetIndex >= 0 && targetIndex < totalSlides && targetIndex !== currentSlideIndex) {
                // Hide current slide
                const currentSlide = document.querySelector(`[data-slide="${currentSlideIndex}"]`);
                if (currentSlide) {
                    currentSlide.style.display = 'none';
                }
                
                // Show target slide
                const targetSlide = document.querySelector(`[data-slide="${targetIndex}"]`);
                if (targetSlide) {
                    targetSlide.style.display = 'flex';
                    targetSlide.classList.add('fade-in');
                }
                
                currentSlideIndex = targetIndex;
                updateSlideNavigation();
            }
        }

        // Show presentation completion message
        function showPresentationComplete() {
            showToast("🎉 Presentasi berhasil dibuat! Scroll ke bawah untuk melihat hasil lengkap.", "success");
        }

        // Reset form
        function resetForm() {
            document.getElementById('presentation-form').reset();
            document.getElementById('presentation-preview').classList.add('hidden');
            
            // Reset AI theme recommendation
            const selectedThemeDisplay = document.getElementById('selected-theme-display');
            if (selectedThemeDisplay) {
                selectedThemeDisplay.classList.add('hidden');
            }
            
            // Clear selected AI theme
            window.selectedAITheme = null;
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            showToast("🔄 Form berhasil direset! AI siap menganalisis pembelajaran baru Anda.", "success");
        }

        // Show toast notification
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `fixed top-4 right-4 px-6 py-3 rounded-lg text-white z-50 max-w-md ${
                type === 'success' ? 'bg-green-500' : 
                type === 'error' ? 'bg-red-500' : 
                type === 'info' ? 'bg-blue-500' : 'bg-gray-500'
            }`;
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 4000);
        }

        // Get subject-specific icon
        function getSubjectIcon(mapel) {
            const iconMap = {
                'matematika': '🔢',
                'ipa': '🔬',
                'sains': '🔬',
                'fisika': '⚛️',
                'kimia': '🧪',
                'biologi': '🧬',
                'bahasa indonesia': '📚',
                'bahasa inggris': '🌍',
                'ips': '🌏',
                'sejarah': '📜',
                'geografi': '🗺️',
                'ekonomi': '💰',
                'pkn': '🏛️',
                'seni': '🎨',
                'olahraga': '⚽',
                'agama': '🕌'
            };
            
            const subject = mapel.toLowerCase();
            for (const key in iconMap) {
                if (subject.includes(key)) {
                    return iconMap[key];
                }
            }
            return '📖'; // default icon
        }

        // Generate agenda content
        function generateAgendaContent(aiContent) {
            return `Rundown pembelajaran hari ini:

⏰ PEMBUKAAN (10 menit)
• Salam dan presensi
• Apersepsi dan motivasi
• Penyampaian tujuan pembelajaran

📖 KEGIATAN INTI (60 menit)
• Pengenalan konsep dan teori dasar
• Eksplorasi materi melalui diskusi interaktif
• Demonstrasi dan contoh aplikasi nyata
• Aktivitas praktik dan eksperimen
• Analisis dan refleksi hasil pembelajaran

✅ PENUTUP (20 menit)
• Rangkuman dan kesimpulan
• Evaluasi pemahaman siswa
• Penugasan dan rencana pembelajaran berikutnya
• Doa dan salam penutup

🎯 METODE: Ceramah interaktif, diskusi, praktik langsung, dan evaluasi formatif`;
        }

        // Generate assessment content
        function generateAssessmentContent(topik, mapel) {
            return `Evaluasi pembelajaran ${topik} akan dilakukan melalui:

📊 PENILAIAN AUTENTIK:
• 📝 Tes Tertulis (30%): Soal pilihan ganda, essay, dan analisis kasus
• 🎭 Praktik Langsung (25%): Demonstrasi penerapan konsep dalam situasi nyata
• 👥 Penilaian Kelompok (20%): Diskusi, presentasi, dan kolaborasi tim
• 📋 Portofolio (15%): Kumpulan tugas dan hasil kerja selama pembelajaran
• 🔍 Observasi (10%): Pengamatan aktivitas, partisipasi, dan sikap belajar

🎯 KRITERIA PENILAIAN:
• Pemahaman Konsep: Menguasai definisi, prinsip, dan teori dasar
• Aplikasi Praktis: Mampu menerapkan pengetahuan dalam kehidupan nyata
• Analisis Kritis: Kemampuan menganalisis, mengevaluasi, dan menyimpulkan
• Komunikasi: Menyampaikan ide dengan jelas, sistematis, dan percaya diri
• Kolaborasi: Bekerja sama dalam tim dengan efektif dan saling menghargai

📈 RUBRIK PENILAIAN:
• Sangat Baik (A): 86-100 | Baik (B): 71-85 | Cukup (C): 56-70 | Kurang (D): ≤55`;
        }

        // Generate comprehensive summary content for effective learning closure
        function generateSummaryContent(topik, mapel) {
            return `🎯 KESIMPULAN PEMBELAJARAN ${topik.toUpperCase()}

🔑 KONSEP KUNCI YANG TELAH DIKUASAI:
• ✅ Memahami definisi dan karakteristik fundamental ${topik}
• ✅ Menguasai prinsip-prinsip dasar yang mendasari ${topik}
• ✅ Mengidentifikasi komponen-komponen penting dalam ${topik}
• ✅ Menganalisis hubungan ${topik} dengan konsep lain dalam ${mapel}
• ✅ Menerapkan pengetahuan ${topik} dalam konteks kehidupan nyata

💡 INSIGHT & PEMAHAMAN MENDALAM:
🔸 Signifikansi ${topik} dalam pembelajaran ${mapel}
• Mengapa ${topik} menjadi fondasi penting dalam ${mapel}
• Bagaimana ${topik} terhubung dengan materi sebelumnya
• Relevansi ${topik} untuk materi pembelajaran selanjutnya

🔸 Keterkaitan Teori dan Praktik
• Penerapan konsep ${topik} dalam situasi nyata
• Contoh-contoh konkret ${topik} di lingkungan sekitar
• Manfaat memahami ${topik} untuk kehidupan sehari-hari

🔸 Pengembangan Kemampuan Berpikir
• Kemampuan analisis dan sintesis yang telah berkembang
• Keterampilan pemecahan masalah terkait ${topik}
• Kemampuan berpikir kritis dan logis yang terasah

🎯 EVALUASI PENCAPAIAN KOMPETENSI:
📊 Aspek Kognitif (Pengetahuan):
• ✅ Menjelaskan konsep ${topik} dengan tepat
• ✅ Mengidentifikasi ciri-ciri dan karakteristik ${topik}
• ✅ Membandingkan dan mengkontraskan aspek-aspek ${topik}

🛠️ Aspek Psikomotor (Keterampilan):
• ✅ Menerapkan prosedur dan metode terkait ${topik}
• ✅ Melakukan analisis dan evaluasi terhadap ${topik}
• ✅ Menggunakan tools dan teknik yang relevan

❤️ Aspek Afektif (Sikap):
• ✅ Menunjukkan antusiasme dalam mempelajari ${topik}
• ✅ Berpartisipasi aktif dalam diskusi dan kegiatan
• ✅ Menghargai pentingnya ${topik} dalam ${mapel}

🚀 RENCANA TINDAK LANJUT & PENGEMBANGAN:
📚 Pendalaman Materi:
• Review kembali catatan dan materi hari ini
• Buat mind map atau diagram konsep ${topik}
• Diskusikan dengan teman untuk memperkuat pemahaman
• Cari sumber referensi tambahan untuk memperluas wawasan

🔍 Eksplorasi Lanjutan:
• Identifikasi aplikasi ${topik} di bidang lain
• Cari contoh-contoh baru ${topik} di lingkungan sekitar
• Hubungkan ${topik} dengan pengalaman pribadi
• Buat proyek kecil yang menerapkan konsep ${topik}

💪 Persiapan Pembelajaran Berikutnya:
• Siapkan pertanyaan mendalam untuk diskusi lanjutan
• Identifikasi aspek ${topik} yang masih perlu diperdalam
• Buat target pembelajaran personal untuk materi selanjutnya
• Refleksikan strategi belajar yang paling efektif

🌟 REFLEKSI PEMBELAJARAN:
"Hari ini kita telah menyelesaikan perjalanan pembelajaran yang bermakna tentang ${topik}. Setiap konsep yang dipelajari, setiap diskusi yang dilakukan, dan setiap aktivitas yang dikerjakan telah memperkaya pemahaman kita tentang ${mapel}. Mari kita bawa ilmu ini untuk diterapkan dalam kehidupan nyata dan menjadi bekal untuk pembelajaran selanjutnya."

🎊 APRESIASI & MOTIVASI:
Selamat! Kalian telah menunjukkan dedikasi dan semangat belajar yang luar biasa. Pemahaman kalian tentang ${topik} akan menjadi fondasi kuat untuk mempelajari konsep-konsep yang lebih kompleks. Terus pertahankan rasa ingin tahu dan semangat belajar ini!`;
        }

        // Generate closing title
        function generateClosingTitle(topik) {
            const titles = [
                `🎉 Selamat! Kalian Telah Menguasai ${topik}!`,
                `🌟 Luar Biasa! ${topik} Sudah Kalian Pahami!`,
                `🏆 Hebat! Kalian Berhasil Mempelajari ${topik}!`,
                `✨ Fantastis! ${topik} Kini Ada di Genggaman Kalian!`,
                `🎊 Bravo! Kalian Sudah Jadi Ahli ${topik}!`
            ];
            return titles[Math.floor(Math.random() * titles.length)];
        }

        // Generate comprehensive closing message for impactful learning conclusion
        function generateClosingMessage(topik, mapel) {
            return `🎊 SELAMAT! PERJALANAN PEMBELAJARAN ${topik.toUpperCase()} TELAH BERHASIL DISELESAIKAN!

🌟 PENCAPAIAN LUAR BIASA HARI INI:
✨ Penguasaan Konsep Fundamental
• Memahami esensi dan karakteristik ${topik} secara mendalam
• Menguasai prinsip-prinsip dasar yang mendasari ${topik}
• Mengidentifikasi komponen-komponen kritis dalam ${topik}
• Menganalisis hubungan ${topik} dengan konsep lain dalam ${mapel}

🎯 Aplikasi Praktis yang Bermakna
• Menerapkan konsep ${topik} dalam situasi kehidupan nyata
• Menganalisis contoh-contoh ${topik} di lingkungan sekitar
• Menghubungkan teori dengan pengalaman praktis
• Memecahkan masalah nyata menggunakan prinsip ${topik}

🤝 Kolaborasi dan Partisipasi Aktif
• Berpartisipasi dengan antusias dalam setiap aktivitas
• Berkontribusi positif dalam diskusi kelompok
• Menunjukkan sikap saling menghargai dan mendukung
• Mengembangkan kemampuan komunikasi dan presentasi

💪 PESAN INSPIRASI & MOTIVASI:

🏗️ "Membangun Fondasi Pengetahuan yang Kokoh"
"Pembelajaran ${mapel} adalah seperti membangun sebuah istana pengetahuan. ${topik} yang kalian pelajari hari ini adalah fondasi yang kokoh dan kuat. Dengan fondasi yang solid ini, kalian dapat membangun menara pengetahuan yang menjulang tinggi, mencapai pemahaman yang mendalam, dan meraih prestasi yang gemilang!"

🌱 "Dari Benih Menjadi Pohon Besar"
"Setiap konsep ${topik} yang kalian serap hari ini adalah benih pengetahuan yang akan tumbuh menjadi pohon kebijaksanaan yang rindang. Terus siram dengan rasa ingin tahu, pupuk dengan latihan yang konsisten, dan rawat dengan semangat belajar yang tak pernah padam!"

🚀 ROADMAP PENGEMBANGAN BERKELANJUTAN:

📚 Pendalaman & Eksplorasi
• Jelajahi aspek-aspek ${topik} yang belum terungkap
• Cari hubungan ${topik} dengan bidang ilmu lainnya
• Buat proyek kreatif yang menerapkan konsep ${topik}
• Diskusikan dengan ahli atau praktisi di bidang ${mapel}
• Baca buku dan artikel terbaru tentang ${topik}

🔬 Penelitian & Inovasi
• Lakukan mini research tentang perkembangan terbaru ${topik}
• Buat hipotesis dan uji coba sederhana terkait ${topik}
• Dokumentasikan temuan dan insight baru
• Bagikan penemuan dengan komunitas belajar
• Ikuti kompetisi atau olimpiade terkait ${mapel}

🌐 Aplikasi & Kontribusi
• Identifikasi masalah nyata yang bisa diselesaikan dengan ${topik}
• Buat solusi inovatif menggunakan prinsip ${topik}
• Ajarkan ${topik} kepada adik kelas atau teman
• Kontribusi dalam proyek komunitas yang relevan
• Buat konten edukatif untuk berbagi pengetahuan

🎯 VISI MASA DEPAN:

🌟 "Menjadi Agen Perubahan"
Dengan pemahaman ${topik} yang kalian miliki, kalian berpotensi menjadi agen perubahan positif di masyarakat. Gunakan ilmu ini untuk menciptakan inovasi, memecahkan masalah, dan memberikan manfaat bagi banyak orang.

🏆 "Meraih Keunggulan Akademik"
Penguasaan ${topik} ini akan menjadi keunggulan kompetitif kalian dalam studi lanjutan. Terus kembangkan dan aplikasikan dalam berbagai konteks untuk meraih prestasi akademik yang membanggakan.

🌍 "Berkontribusi untuk Dunia"
Ilmu ${topik} yang kalian kuasai dapat menjadi kontribusi nyata untuk kemajuan bangsa dan dunia. Jadilah generasi yang tidak hanya pintar, tetapi juga bermanfaat bagi sesama.

💝 APRESIASI & TERIMA KASIH:
Terima kasih atas dedikasi, antusiasme, dan semangat belajar yang luar biasa! Kalian telah membuktikan bahwa dengan tekad yang kuat dan usaha yang konsisten, tidak ada yang tidak mungkin untuk dicapai.

🌈 PENUTUP YANG MENGINSPIRASI:
"Ingatlah, setiap master pernah menjadi disaster, setiap ahli pernah menjadi pemula, dan setiap sukses dimulai dari langkah pertama yang berani. Kalian telah mengambil langkah penting hari ini. Terus melangkah dengan percaya diri menuju masa depan yang gemilang!"

🎓 Sampai jumpa di petualangan pembelajaran selanjutnya yang akan lebih menantang dan menyenangkan! Keep learning, keep growing, keep shining! ✨

📖 REFLEKSI AKHIR:
"Hari ini bukan akhir dari pembelajaran, tetapi awal dari perjalanan panjang menuju keahlian. Setiap pertanyaan yang muncul adalah pintu menuju pengetahuan baru. Setiap kesulitan yang dihadapi adalah tangga menuju kesuksesan. Mari kita jadikan ${topik} sebagai bekal untuk meraih mimpi dan cita-cita!"`;
        }
        }

        // AI Content Generator - Generates comprehensive, complete presentation content ready for classroom delivery
        function generateDetailedContent(topik, mapel, kelas) {
            // Grade level adaptation system
            const gradeLevel = determineGradeLevel(kelas);
            
            const contentDatabase = {
                // MATEMATIKA
                'pecahan': {
                    pengenalan: `🍕 SELAMAT DATANG DI DUNIA PECAHAN!

Halo anak-anak! Hari ini kita akan belajar tentang PECAHAN. Siapa yang suka pizza? Nah, pecahan itu seperti pizza yang dipotong-potong!

🎯 APA ITU PECAHAN?
Pecahan adalah cara untuk menunjukkan BAGIAN dari sesuatu yang UTUH. 

Contoh mudahnya:
• Pizza dipotong jadi 8 bagian → kamu makan 3 potong = 3/8
• Cokelat batang dipotong jadi 4 bagian → adik makan 1 bagian = 1/4
• Kue ulang tahun dipotong jadi 6 bagian → mama ambil 2 bagian = 2/6

📍 DI MANA kita temukan pecahan setiap hari?
🏠 Di Rumah:
• Mama masak pakai 1/2 cangkir tepung
• Papa minum 3/4 gelas kopi
• Kamu tidur siang 1/2 jam (30 menit)

🏪 Di Toko:
• Diskon sepatu 1/4 dari harga asli
• Beli 1/2 kg apel
• Promo beli 2 gratis 1/3

🏫 Di Sekolah:
• Istirahat 1/4 jam (15 menit)
• Selesai 2/3 dari PR matematika
• Bagi kue untuk 8 teman, dapat 1/8 bagian`,
                    teori: `📚 MARI PELAJARI TEORI PECAHAN LEBIH DALAM!

🎯 BAGIAN-BAGIAN PECAHAN:

Setiap pecahan punya 3 bagian penting:

🔸 PEMBILANG (Angka Atas):
• Menunjukkan berapa bagian yang kita AMBIL atau PAKAI
• Contoh: Dalam 3/4, angka 3 adalah pembilang
• Artinya kita mengambil 3 bagian dari total
• Seperti: "Aku makan 3 potong pizza"

🔸 PENYEBUT (Angka Bawah):
• Menunjukkan berapa bagian TOTAL yang ada
• Contoh: Dalam 3/4, angka 4 adalah penyebut  
• Artinya total ada 4 bagian
• Seperti: "Pizza dipotong jadi 4 bagian"

🔸 GARIS PECAHAN (Garis Tengah):
• Garis yang memisahkan pembilang dan penyebut
• Artinya "DIBAGI DENGAN" atau "DARI"
• Seperti tanda ÷ dalam pembagian
• Dibaca: "3 dari 4" atau "3 per 4"`,
                    contohKehidupan: `🌟 PECAHAN ADA DI MANA-MANA! MARI KITA JELAJAHI!

🏠 PETUALANGAN PECAHAN DI RUMAH:

🍳 Di Dapur Bersama Mama:
• Mama buat kue pakai 1/2 cangkir tepung + 1/4 cangkir gula
• Resep puding: 3/4 liter susu + 1/8 kg gula
• Potong semangka jadi 8 bagian, kamu makan 3/8 bagian
• Bagi pizza keluarga: Papa 2/8, Mama 2/8, Kamu 2/8, Adik 2/8
• Minum jus jeruk 1/2 gelas setiap pagi

🕐 Waktu dan Kegiatan Sehari-hari:
• Bangun tidur jam 6 pagi = 1/4 hari sudah berlalu
• Main game 1/4 jam = 15 menit (seru tapi jangan lama-lama!)
• Nonton kartun favorit 1/2 jam = 30 menit
• Tidur siang 3/4 jam = 45 menit (biar segar lagi)
• Belajar 2/3 jam = 40 menit setiap hari`,
                    latihanPraktik: `🎯 KEGIATAN SERU & PRAKTIK LANGSUNG BELAJAR PECAHAN!

Mari kita praktik langsung supaya makin paham! Siap-siap seru-seruan sambil belajar!

🍕 WORKSHOP PIZZA PECAHAN (30 menit):

Alat yang dibutuhkan:
• Kertas karton warna-warni
• Gunting dan lem
• Spidol warna
• Jangka atau piring untuk cetak lingkaran

Langkah-langkah:
1️⃣ Buat 4 pizza dari kertas (lingkaran besar)
2️⃣ Pizza 1: Potong jadi 2 bagian (1/2)
3️⃣ Pizza 2: Potong jadi 4 bagian (1/4, 2/4, 3/4, 4/4)
4️⃣ Pizza 3: Potong jadi 8 bagian (1/8, 2/8, 3/8, dst)
5️⃣ Pizza 4: Potong jadi 6 bagian (1/6, 2/6, 3/6, dst)
6️⃣ Warnai setiap bagian dengan warna berbeda
7️⃣ Tulis pecahan di setiap potongan
8️⃣ Coba susun kembali dan bandingkan ukurannya!`
                },
                'fotosintesis': {
                    pengenalan: `🌱 SELAMAT DATANG DI DUNIA AJAIB FOTOSINTESIS!

Halo anak-anak! Pernahkah kalian bertanya-tanya bagaimana tumbuhan bisa hidup tanpa makan seperti kita? Ternyata, tumbuhan punya cara super keren untuk membuat makanan sendiri! Namanya FOTOSINTESIS!

🎯 APA ITU FOTOSINTESIS?
Fotosintesis adalah cara AJAIB tumbuhan membuat makanan sendiri menggunakan sinar matahari! Bayangkan tumbuhan seperti koki yang memasak makanan dengan bantuan matahari sebagai kompor!

Contoh mudahnya:
• Pohon mangga di halaman = pabrik makanan mini
• Daun hijau = dapur tempat memasak
• Sinar matahari = api kompor untuk memasak
• Air dari akar = bahan masakan
• Udara (CO₂) = bumbu masakan`,
                    teori: `📚 MEKANISME FOTOSINTESIS YANG MENAKJUBKAN!

🎯 TAHAPAN FOTOSINTESIS:

🔸 REAKSI TERANG (Light Reaction):
• Terjadi di tilakoid (bagian dalam kloroplas)
• Klorofil menangkap energi cahaya matahari
• Air (H₂O) dipecah menjadi hidrogen dan oksigen
• Oksigen dilepaskan ke udara (yang kita hirup!)
• Energi disimpan dalam bentuk ATP dan NADPH

🔸 REAKSI GELAP (Siklus Calvin):
• Terjadi di stroma (cairan dalam kloroplas)
• CO₂ dari udara "ditangkap" dan diolah
• Menggunakan ATP dan NADPH dari reaksi terang
• Menghasilkan glukosa (gula = makanan tumbuhan)

🔸 PERSAMAAN KIMIA FOTOSINTESIS:
6CO₂ + 6H₂O + cahaya → C₆H₁₂O₆ + 6O₂ + 6H₂O
(Karbon dioksida + Air + Cahaya → Glukosa + Oksigen + Air)`,
                    contohKehidupan: `🌍 FOTOSINTESIS: PAHLAWAN KEHIDUPAN DI BUMI!

🫁 OKSIGEN YANG KITA HIRUP:
• Setiap napas (21% udara) = hasil fotosintesis
• 1 pohon besar = oksigen untuk 2 orang per hari
• Hutan Amazon = "paru-paru dunia" menghasilkan 20% oksigen bumi
• Fitoplankton di laut = 70% oksigen dunia

🍽️ MAKANAN DI MEJA KITA:
• Nasi, jagung, gandum = langsung dari fotosintesis
• Sayuran dan buah-buahan = produk fotosintesis
• Daging sapi, ayam = dari hewan yang makan tumbuhan
• Madu = dari nektar bunga hasil fotosintesis

⚡ ENERGI UNTUK KEHIDUPAN:
• Kayu bakar = energi matahari yang tersimpan
• Batu bara = fosil tumbuhan purba (fotosintesis jutaan tahun lalu)
• Minyak bumi = sisa organisme laut yang berfotosintesis
• Biofuel = etanol dari jagung dan tebu`,
                    latihanPraktik: `🔬 EKSPERIMEN SERU MEMBUKTIKAN FOTOSINTESIS!

Mari kita jadi ilmuwan cilik dan buktikan fotosintesis benar-benar terjadi!

🧪 EKSPERIMEN 1: GELEMBUNG OKSIGEN AJAIB (20 menit)
Alat: Tanaman air (Hydrilla), gelas bening, lampu, air
Langkah:
1️⃣ Masukkan Hydrilla ke dalam gelas berisi air
2️⃣ Tutup dengan corong terbalik dan tabung reaksi
3️⃣ Letakkan di bawah lampu terang
4️⃣ Amati gelembung gas yang keluar dari daun
5️⃣ Kumpulkan gas dalam tabung, nyalakan lidi → api menyala terang!

🌿 EKSPERIMEN 2: UJI AMILUM DAUN (30 menit)
Alat: Daun segar, alkohol, iodium, kompor, panci
Langkah:
1️⃣ Rebus daun dalam air panas 5 menit
2️⃣ Rendam dalam alkohol panas (hilangkan klorofil)
3️⃣ Tetesi dengan larutan iodium
4️⃣ Warna biru-hitam = ada amilum (hasil fotosintesis)!`
                },
                'sistem pencernaan': {
                    pengenalan: `🍎 PETUALANGAN MAKANAN DI DALAM TUBUH KITA!

Halo teman-teman! Pernahkah kalian penasaran kemana perginya makanan setelah kita makan? Hari ini kita akan mengikuti perjalanan seru makanan dari mulut sampai... keluar lagi! 😄

🎯 APA ITU SISTEM PENCERNAAN?
Sistem pencernaan adalah "pabrik pengolahan makanan" di dalam tubuh kita yang super canggih! Tugasnya mengubah makanan menjadi energi dan nutrisi yang dibutuhkan tubuh.

🚂 PERJALANAN MAKANAN (seperti kereta api):
• Stasiun 1: MULUT (pemecahan awal)
• Stasiun 2: KERONGKONGAN (jalan menuju perut)
• Stasiun 3: LAMBUNG (pencernaan utama)
• Stasiun 4: USUS HALUS (penyerapan nutrisi)
• Stasiun 5: USUS BESAR (pembuangan sisa)

⏱️ WAKTU PERJALANAN TOTAL: 24-72 jam!`,
                    teori: `🔬 ANATOMI DAN FISIOLOGI SISTEM PENCERNAAN

🦷 MULUT (Cavitas Oris):
• Gigi: Memotong (seri), merobek (taring), mengunyah (geraham)
• Lidah: Mengaduk makanan, mengecap rasa, membantu menelan
• Kelenjar ludah: Menghasilkan saliva dengan enzim amilase
• Fungsi: Pencernaan mekanis dan kimiawi awal

🫁 KERONGKONGAN (Esofagus):
• Panjang: ±25 cm, diameter 2 cm
• Gerak peristaltik: Kontraksi otot mendorong makanan
• Sfingter esofagus: Katup pencegah makanan naik kembali
• Waktu tempuh: 4-8 detik untuk cairan, 4-8 menit untuk padat

🥄 LAMBUNG (Gaster):
• Kapasitas: 1-1,5 liter (bisa mengembang hingga 4 liter)
• Asam lambung (HCl): pH 1,5-3,5 (sangat asam!)
• Enzim pepsin: Memecah protein menjadi peptida
• Waktu pencernaan: 2-6 jam tergantung jenis makanan`,
                    contohKehidupan: `🍽️ SISTEM PENCERNAAN DALAM KEHIDUPAN SEHARI-HARI

🥗 MAKANAN SEHAT VS TIDAK SEHAT:
Makanan Sehat (Mudah Dicerna):
• Buah-buahan: 30 menit - 2 jam
• Sayuran: 30-45 menit  
• Nasi/roti: 1-3 jam
• Ikan: 2-3 jam
• Daging tanpa lemak: 3-4 jam

Makanan Berat (Sulit Dicerna):
• Gorengan: 4-6 jam
• Daging berlemak: 6-8 jam
• Makanan pedas: Iritasi lambung
• Makanan dingin: Memperlambat pencernaan

💧 PENTINGNYA AIR:
• Membantu produksi saliva
• Melarutkan nutrisi
• Memperlancar gerak peristaltik
• Mencegah sembelit
• Kebutuhan: 8-10 gelas per hari`,
                    latihanPraktik: `🧪 SIMULASI DAN EKSPERIMEN SISTEM PENCERNAAN

🦷 AKTIVITAS 1: SIMULASI PENCERNAAN DI MULUT (15 menit)
Alat: Roti tawar, air, kantong plastik, tangan
Langkah:
1️⃣ Sobek roti jadi potongan kecil (simulasi gigi)
2️⃣ Masukkan ke kantong plastik dengan sedikit air (simulasi saliva)
3️⃣ Remas-remas dengan tangan (simulasi pengunyahan)
4️⃣ Amati perubahan tekstur dan bentuk roti

🥤 AKTIVITAS 2: UJI ENZIM AMILASE (20 menit)
Alat: Nasi, air ludah, iodium, 2 gelas
Langkah:
1️⃣ Gelas A: Nasi + air biasa
2️⃣ Gelas B: Nasi + air ludah
3️⃣ Diamkan 10 menit
4️⃣ Tetesi iodium pada kedua gelas
5️⃣ Bandingkan warna (biru = amilum, tidak biru = sudah dipecah enzim)`
                },
                'teks narasi': {
                    pengenalan: `📚 SELAMAT DATANG DI DUNIA CERITA YANG MENAKJUBKAN!

Halo para penulis muda! Hari ini kita akan menjelajahi dunia TEKS NARASI - seni bercerita yang telah ada sejak zaman nenek moyang kita!

🎯 APA ITU TEKS NARASI?
Teks narasi adalah jenis tulisan yang menceritakan suatu peristiwa atau kejadian secara kronologis (berurutan waktu). Seperti kita sedang bercerita kepada teman tentang pengalaman seru!

📖 JENIS-JENIS NARASI:
• Narasi Ekspositoris: Menceritakan fakta (berita, biografi)
• Narasi Sugestif: Menceritakan fiksi (cerpen, novel, dongeng)
• Narasi Informatif: Memberikan informasi sambil bercerita
• Narasi Artistik: Fokus pada keindahan bahasa dan gaya

🌟 CONTOH DALAM KEHIDUPAN:
• Menceritakan liburan ke pantai
• Dongeng sebelum tidur
• Film dan drama TV
• Komik dan novel
• Postingan media sosial tentang pengalaman`,
                    teori: `📝 STRUKTUR DAN UNSUR TEKS NARASI

🏗️ STRUKTUR TEKS NARASI:

🔸 ORIENTASI (Pengenalan):
• Memperkenalkan tokoh, tempat, dan waktu
• Memberikan gambaran awal situasi cerita
• Menarik perhatian pembaca dari awal
• Contoh: "Pada suatu hari di desa Sukamaju, hiduplah seorang anak bernama Budi..."

🔸 KOMPLIKASI (Masalah):
• Munculnya konflik atau masalah dalam cerita
• Puncak ketegangan yang membuat cerita menarik
• Tokoh menghadapi tantangan atau rintangan
• Contoh: "Tiba-tiba, Budi mendengar teriakan minta tolong dari hutan..."

🔸 RESOLUSI (Penyelesaian):
• Pemecahan masalah atau konflik
• Akhir cerita yang memberikan kepuasan
• Pesan moral atau pembelajaran
• Contoh: "Berkat keberanian Budi, anak yang tersesat berhasil diselamatkan..."

👥 UNSUR INTRINSIK NARASI:
• Tokoh: Pelaku dalam cerita (protagonis, antagonis)
• Alur: Jalan cerita (maju, mundur, campuran)
• Latar: Tempat, waktu, suasana
• Sudut pandang: Orang pertama (aku) atau ketiga (dia)
• Tema: Pesan utama cerita
• Amanat: Nilai moral yang disampaikan`,
                    contohKehidupan: `🌍 TEKS NARASI DI SEKITAR KITA

📱 MEDIA SOSIAL DAN DIGITAL:
• Instagram Stories: Narasi visual harian
• TikTok: Narasi pendek dengan video
• Blog pribadi: Narasi pengalaman dan perjalanan
• Vlog YouTube: Narasi audiovisual
• Thread Twitter: Narasi bersambung

📺 HIBURAN DAN MEDIA:
• Film bioskop: Narasi visual dengan alur kompleks
• Serial TV: Narasi episodik dengan karakter berkembang
• Anime dan kartun: Narasi dengan gaya visual unik
• Podcast: Narasi audio dengan storytelling
• Game RPG: Narasi interaktif dengan pilihan

📚 SASTRA DAN PENDIDIKAN:
• Novel remaja: Narasi dengan tema kehidupan remaja
• Cerpen di majalah: Narasi pendek dengan pesan mendalam
• Biografi tokoh: Narasi faktual inspiratif
• Legenda daerah: Narasi tradisional dengan nilai budaya
• Fabel: Narasi dengan tokoh hewan dan moral`,
                    latihanPraktik: `✍️ WORKSHOP MENULIS NARASI KREATIF

📝 AKTIVITAS 1: MENULIS NARASI PENGALAMAN (30 menit)
Tema: "Hari Pertama di Sekolah Baru"
Langkah:
1️⃣ Brainstorming: Tulis 5 perasaan saat hari pertama sekolah
2️⃣ Buat kerangka: Orientasi → Komplikasi → Resolusi
3️⃣ Kembangkan menjadi paragraf lengkap
4️⃣ Gunakan dialog untuk menghidupkan cerita
5️⃣ Tambahkan deskripsi suasana dan perasaan

🎭 AKTIVITAS 2: NARASI KOLABORATIF (25 menit)
Aturan: Setiap siswa melanjutkan cerita dari teman sebelumnya
1️⃣ Siswa 1: Tulis orientasi (2-3 kalimat)
2️⃣ Siswa 2: Lanjutkan dengan komplikasi
3️⃣ Siswa 3: Tambahkan perkembangan masalah
4️⃣ Siswa 4: Buat resolusi dan penutup
5️⃣ Bacakan hasil karya bersama di depan kelas

🖼️ AKTIVITAS 3: NARASI DARI GAMBAR (20 menit)
Alat: Gambar/foto menarik, kertas, pulpen
Langkah:
1️⃣ Amati gambar dengan seksama
2️⃣ Buat pertanyaan: Siapa? Dimana? Kapan? Mengapa?
3️⃣ Kembangkan jawaban menjadi cerita utuh
4️⃣ Fokus pada detail dan emosi tokoh
5️⃣ Berikan judul yang menarik dan sesuai`
                }
            };

            // Normalize topic for matching
            const normalizedTopic = topik.toLowerCase().trim();
            
            // Try to find exact match or partial match
            let matchedContent = null;
            
            // Exact match
            if (contentDatabase[normalizedTopic]) {
                matchedContent = contentDatabase[normalizedTopic];
            } else {
                // Partial match
                for (const key in contentDatabase) {
                    if (normalizedTopic.includes(key) || key.includes(normalizedTopic)) {
                        matchedContent = contentDatabase[key];
                        break;
                    }
                }
            }
            
            // If no match found, generate generic content
            if (!matchedContent) {
                matchedContent = generateGenericContent(topik, mapel, kelas);
            }
            
            // Add specific learning objectives
            const tujuan = `Setelah mengikuti pembelajaran tentang ${topik}, siswa diharapkan mampu:

• Memahami konsep dasar dan definisi ${topik}
• Menganalisis komponen-komponen penting dalam ${topik}
• Menerapkan pengetahuan ${topik} dalam situasi nyata
• Mengevaluasi dan membuat kesimpulan tentang ${topik}
• Mengkomunikasikan pemahaman ${topik} dengan jelas`;

            return {
                tujuan: tujuan,
                pengenalan: matchedContent.pengenalan,
                teori: matchedContent.teori,
                contohKehidupan: matchedContent.contohKehidupan,
                latihanPraktik: matchedContent.latihanPraktik
            };
        }

        // Generate generic content for topics not in database
        function generateGenericContent(topik, mapel, kelas) {
            return {
                pengenalan: `${topik} adalah salah satu konsep penting dalam ${mapel} yang perlu dipahami siswa ${kelas}. Topik ini memiliki relevansi tinggi dengan kehidupan sehari-hari dan menjadi dasar untuk memahami konsep-konsep lanjutan.

• Definisi: Konsep fundamental dalam ${mapel}
• Ruang lingkup: Mencakup teori dan aplikasi praktis
• Pentingnya: Dasar untuk pembelajaran selanjutnya
• Aplikasi: Dapat diterapkan dalam berbagai situasi`,
                teori: `Konsep dasar ${topik} meliputi beberapa prinsip fundamental:

• Prinsip 1: Landasan teoritis yang mendasari ${topik}
• Prinsip 2: Hubungan antar komponen dalam ${topik}
• Prinsip 3: Aturan dan pola yang berlaku dalam ${topik}
• Prinsip 4: Metode analisis dan pemecahan masalah
• Prinsip 5: Evaluasi dan interpretasi hasil`,
                contohKehidupan: `${topik} dapat ditemukan dalam berbagai aspek kehidupan:

• Kehidupan sehari-hari: Aplikasi langsung dalam aktivitas harian
• Teknologi: Penerapan dalam perangkat dan sistem modern
• Lingkungan: Keterkaitan dengan fenomena alam sekitar
• Sosial: Dampak dan manfaat bagi masyarakat
• Masa depan: Relevansi untuk perkembangan selanjutnya`,
                latihanPraktik: `Aktivitas pembelajaran untuk menguasai ${topik}:

• Aktivitas 1: Observasi dan identifikasi ${topik} di lingkungan sekitar
• Aktivitas 2: Eksperimen sederhana untuk membuktikan konsep
• Aktivitas 3: Diskusi kelompok tentang aplikasi ${topik}
• Aktivitas 4: Presentasi hasil analisis dan temuan
• Aktivitas 5: Refleksi dan evaluasi pemahaman konsep`
            };
        }

        // Grade level determination system
        function determineGradeLevel(kelas) {
            const kelasLower = kelas.toLowerCase();
            
            // Elementary (SD/MI) - Kelas 1-6, Fase A-C
            if (kelasLower.includes('sd') || kelasLower.includes('mi') || 
                kelasLower.includes('fase a') || kelasLower.includes('fase b') || kelasLower.includes('fase c') ||
                /kelas [1-6]/.test(kelasLower) || /^[1-6]$/.test(kelas.trim())) {
                return 'elementary';
            }
            
            // Middle School (SMP/MTs) - Kelas 7-9, Fase D
            if (kelasLower.includes('smp') || kelasLower.includes('mts') || 
                kelasLower.includes('fase d') ||
                /kelas [7-9]/.test(kelasLower) || /^[7-9]$/.test(kelas.trim())) {
                return 'middle';
            }
            
            // High School (SMA/SMK/MA) - Kelas 10-12, Fase E-F
            if (kelasLower.includes('sma') || kelasLower.includes('smk') || kelasLower.includes('ma') ||
                kelasLower.includes('fase e') || kelasLower.includes('fase f') ||
                /kelas 1[0-2]/.test(kelasLower) || /^1[0-2]$/.test(kelas.trim())) {
                return 'high';
            }
            
            // Default to middle if unclear
            return 'middle';
        }

        // Generate educational backgrounds with comprehensive visual elements
        function getEducationalBackground(templateType) {
            const backgrounds = {
                mathematics: `
                    <div class="geometric-bg"></div>
                    
                    <!-- Student with Calculator -->
                    <svg class="student-illustration" style="top: 10%; right: 5%; width: 120px; height: 120px;" viewBox="0 0 200 200" fill="none">
                        <circle cx="100" cy="60" r="25" fill="#FFE4B5" stroke="#D2691E" stroke-width="2"/>
                        <circle cx="90" cy="55" r="2" fill="#000"/>
                        <circle cx="110" cy="55" r="2" fill="#000"/>
                        <path d="M95 65 Q100 70 105 65" stroke="#000" stroke-width="1.5" fill="none"/>
                        <rect x="80" y="85" width="40" height="60" fill="#4169E1" rx="5"/>
                        <rect x="70" y="100" width="60" height="40" fill="#FFD700" rx="3"/>
                        <rect x="75" y="105" width="50" height="30" fill="#000" opacity="0.1"/>
                        <text x="100" y="120" text-anchor="middle" fill="#000" font-size="8">123+</text>
                        <circle cx="85" cy="130" r="2" fill="#000"/>
                        <circle cx="100" cy="130" r="2" fill="#000"/>
                        <circle cx="115" cy="130" r="2" fill="#000"/>
                    </svg>
                    
                    <!-- Chalkboard with Math -->
                    <div class="chalkboard" style="top: 15%; left: 8%; width: 100px; height: 60px;">
                        <div style="color: white; font-size: 12px; text-align: center; padding-top: 15px;">
                            <div>2x + 3 = 7</div>
                            <div style="margin-top: 5px;">x = 2</div>
                        </div>
                    </div>
                    
                    <!-- Floating Math Formulas -->
                    <div class="math-formula" style="top: 15%; left: 10%;">∫ f(x)dx</div>
                    <div class="math-formula" style="top: 60%; right: 15%;">π = 3.14159...</div>
                    <div class="math-formula" style="bottom: 20%; left: 20%;">x² + y² = r²</div>
                    
                    <!-- Calculator Animation -->
                    <div class="calculator-math" style="bottom: 15%; right: 12%;">
                        <svg width="60" height="80" viewBox="0 0 60 80" fill="rgba(255,255,255,0.2)">
                            <rect x="5" y="5" width="50" height="70" fill="#333" rx="5"/>
                            <rect x="10" y="10" width="40" height="15" fill="#000" rx="2"/>
                            <circle cx="20" cy="35" r="4" fill="#666"/>
                            <circle cx="30" cy="35" r="4" fill="#666"/>
                            <circle cx="40" cy="35" r="4" fill="#666"/>
                            <circle cx="20" cy="45" r="4" fill="#666"/>
                            <circle cx="30" cy="45" r="4" fill="#666"/>
                            <circle cx="40" cy="45" r="4" fill="#666"/>
                        </svg>
                    </div>
                    
                    <!-- Book Stack -->
                    <div class="book-stack" style="bottom: 20%; left: 10%; opacity: 0.15;">
                        <svg width="80" height="60" viewBox="0 0 80 60">
                            <rect x="10" y="40" width="60" height="8" fill="#FF6B6B" rx="2"/>
                            <rect x="12" y="30" width="56" height="8" fill="#4ECDC4" rx="2"/>
                            <rect x="14" y="20" width="52" height="8" fill="#45B7D1" rx="2"/>
                            <rect x="16" y="10" width="48" height="8" fill="#96CEB4" rx="2"/>
                        </svg>
                    </div>
                `,
                science: `
                    <div class="dna-helix">
                        <div class="dna-strand"></div>
                        <div class="dna-strand"></div>
                    </div>
                    <div class="circuit-lines"></div>
                    
                    <!-- Student with Microscope -->
                    <svg class="student-illustration" style="top: 12%; left: 8%; width: 140px; height: 140px;" viewBox="0 0 200 200" fill="none">
                        <circle cx="100" cy="50" r="25" fill="#FFE4B5" stroke="#D2691E" stroke-width="2"/>
                        <circle cx="90" cy="45" r="2" fill="#000"/>
                        <circle cx="110" cy="45" r="2" fill="#000"/>
                        <path d="M95 55 Q100 60 105 55" stroke="#000" stroke-width="1.5" fill="none"/>
                        <rect x="80" y="75" width="40" height="50" fill="#FFFFFF" rx="5"/>
                        <rect x="85" y="80" width="30" height="20" fill="#4169E1"/>
                        <text x="100" y="92" text-anchor="middle" fill="#FFF" font-size="8">LAB</text>
                        <!-- Microscope -->
                        <rect x="130" y="90" width="30" height="40" fill="#333"/>
                        <circle cx="145" cy="85" r="8" fill="#666"/>
                        <rect x="140" y="75" width="10" height="15" fill="#333"/>
                        <circle cx="145" cy="130" r="12" fill="#444"/>
                    </svg>
                    
                    <!-- Laboratory Equipment -->
                    <div class="microscope-science" style="bottom: 15%; right: 10%; opacity: 0.2;">
                        <svg width="100" height="120" viewBox="0 0 100 120">
                            <rect x="40" y="80" width="20" height="40" fill="#333"/>
                            <circle cx="50" cy="70" r="15" fill="#666"/>
                            <rect x="45" y="50" width="10" height="25" fill="#333"/>
                            <circle cx="50" cy="45" r="8" fill="#444"/>
                            <rect x="30" y="115" width="40" height="5" fill="#333"/>
                            <circle cx="50" cy="25" r="12" fill="#4169E1"/>
                        </svg>
                    </div>
                    
                    <!-- Test Tubes -->
                    <div class="classroom-elements" style="top: 20%; right: 15%; opacity: 0.2;">
                        <svg width="80" height="100" viewBox="0 0 80 100">
                            <rect x="15" y="20" width="8" height="60" fill="#FF6B6B" rx="4"/>
                            <rect x="30" y="15" width="8" height="65" fill="#4ECDC4" rx="4"/>
                            <rect x="45" y="25" width="8" height="55" fill="#45B7D1" rx="4"/>
                            <rect x="10" y="80" width="60" height="15" fill="#8B4513" rx="5"/>
                        </svg>
                    </div>
                    
                    <!-- Atom Model -->
                    <div class="rotate-animation" style="top: 25%; left: 12%; opacity: 0.15;">
                        <svg width="100" height="100" viewBox="0 0 100 100">
                            <circle cx="50" cy="50" r="6" fill="#FF6B6B"/>
                            <ellipse cx="50" cy="50" rx="35" ry="15" fill="none" stroke="#4ECDC4" stroke-width="2"/>
                            <ellipse cx="50" cy="50" rx="15" ry="35" fill="none" stroke="#45B7D1" stroke-width="2"/>
                            <circle cx="75" cy="50" r="3" fill="#4ECDC4"/>
                            <circle cx="50" cy="25" r="3" fill="#45B7D1"/>
                            <circle cx="25" cy="50" r="3" fill="#4ECDC4"/>
                            <circle cx="50" cy="75" r="3" fill="#45B7D1"/>
                        </svg>
                    </div>
                    
                    <div class="particle-bg">
                        ${Array.from({length: 15}, (_, i) => `
                            <div class="particle" style="
                                left: ${Math.random() * 100}%; 
                                width: ${4 + Math.random() * 8}px; 
                                height: ${4 + Math.random() * 8}px;
                                animation-delay: ${Math.random() * 6}s;
                                animation-duration: ${4 + Math.random() * 4}s;
                            "></div>
                        `).join('')}
                    </div>
                `,
                environment: `
                    <div class="wave-animation"></div>
                    
                    <!-- Student Planting Tree -->
                    <svg class="student-illustration" style="top: 15%; right: 8%; width: 130px; height: 130px;" viewBox="0 0 200 200" fill="none">
                        <circle cx="100" cy="50" r="25" fill="#FFE4B5" stroke="#D2691E" stroke-width="2"/>
                        <circle cx="90" cy="45" r="2" fill="#000"/>
                        <circle cx="110" cy="45" r="2" fill="#000"/>
                        <path d="M95 55 Q100 60 105 55" stroke="#000" stroke-width="1.5" fill="none"/>
                        <rect x="80" y="75" width="40" height="50" fill="#228B22" rx="5"/>
                        <text x="100" y="92" text-anchor="middle" fill="#FFF" font-size="6">ECO</text>
                        <!-- Tree being planted -->
                        <rect x="130" y="110" width="4" height="20" fill="#8B4513"/>
                        <circle cx="132" cy="105" r="12" fill="#228B22"/>
                        <circle cx="125" cy="100" r="8" fill="#32CD32"/>
                        <circle cx="139" cy="98" r="8" fill="#32CD32"/>
                        <!-- Shovel -->
                        <rect x="70" y="90" width="3" height="30" fill="#8B4513"/>
                        <rect x="68" y="88" width="7" height="8" fill="#696969"/>
                    </svg>
                    
                    <!-- Recycling Symbol -->
                    <div class="rotate-animation" style="bottom: 20%; left: 10%; opacity: 0.2;">
                        <svg width="80" height="80" viewBox="0 0 80 80">
                            <path d="M40 10 L50 25 L30 25 Z" fill="#228B22"/>
                            <path d="M65 35 L75 50 L55 50 Z" fill="#228B22" transform="rotate(120 40 40)"/>
                            <path d="M25 35 L35 50 L15 50 Z" fill="#228B22" transform="rotate(240 40 40)"/>
                            <circle cx="40" cy="40" r="15" fill="none" stroke="#228B22" stroke-width="3"/>
                        </svg>
                    </div>
                    
                    <!-- Solar Panel -->
                    <div class="classroom-elements" style="top: 20%; left: 12%; opacity: 0.15;">
                        <svg width="100" height="60" viewBox="0 0 100 60">
                            <rect x="10" y="20" width="80" height="30" fill="#191970" rx="3"/>
                            <rect x="15" y="25" width="15" height="20" fill="#4169E1"/>
                            <rect x="35" y="25" width="15" height="20" fill="#4169E1"/>
                            <rect x="55" y="25" width="15" height="20" fill="#4169E1"/>
                            <rect x="75" y="25" width="10" height="20" fill="#4169E1"/>
                            <rect x="45" y="50" width="10" height="8" fill="#8B4513"/>
                        </svg>
                    </div>
                    
                    <!-- Wind Turbine -->
                    <div class="rotate-animation" style="bottom: 25%; right: 15%; opacity: 0.15;">
                        <svg width="60" height="100" viewBox="0 0 60 100">
                            <rect x="28" y="40" width="4" height="50" fill="#DCDCDC"/>
                            <rect x="20" y="85" width="20" height="10" fill="#696969"/>
                            <ellipse cx="30" cy="35" rx="25" ry="8" fill="#F0F0F0"/>
                            <ellipse cx="30" cy="35" rx="25" ry="8" fill="#F0F0F0" transform="rotate(120 30 35)"/>
                            <ellipse cx="30" cy="35" rx="25" ry="8" fill="#F0F0F0" transform="rotate(240 30 35)"/>
                        </svg>
                    </div>
                    
                    ${Array.from({length: 8}, (_, i) => `
                        <div class="leaf-animation" style="
                            left: ${10 + Math.random() * 80}%; 
                            animation-delay: ${Math.random() * 6}s;
                            animation-duration: ${4 + Math.random() * 4}s;
                        "></div>
                    `).join('')}
                `,
                health: `
                    <!-- Student Exercising -->
                    <svg class="student-illustration" style="top: 10%; left: 10%; width: 140px; height: 140px;" viewBox="0 0 200 200" fill="none">
                        <circle cx="100" cy="50" r="25" fill="#FFE4B5" stroke="#D2691E" stroke-width="2"/>
                        <circle cx="90" cy="45" r="2" fill="#000"/>
                        <circle cx="110" cy="45" r="2" fill="#000"/>
                        <path d="M95 55 Q100 60 105 55" stroke="#000" stroke-width="1.5" fill="none"/>
                        <rect x="80" y="75" width="40" height="50" fill="#FF6347" rx="5"/>
                        <text x="100" y="92" text-anchor="middle" fill="#FFF" font-size="6">SPORT</text>
                        <!-- Dumbbells -->
                        <rect x="60" y="85" width="15" height="4" fill="#696969"/>
                        <circle cx="58" cy="87" r="6" fill="#2F4F4F"/>
                        <circle cx="77" cy="87" r="6" fill="#2F4F4F"/>
                        <rect x="125" y="85" width="15" height="4" fill="#696969"/>
                        <circle cx="123" cy="87" r="6" fill="#2F4F4F"/>
                        <circle cx="142" cy="87" r="6" fill="#2F4F4F"/>
                    </svg>
                    
                    <!-- Heart Monitor -->
                    <div class="heartbeat" style="top: 20%; right: 10%; opacity: 0.2;">
                        <svg width="120" height="80" viewBox="0 0 120 80">
                            <rect x="10" y="10" width="100" height="60" fill="#000" rx="5"/>
                            <path d="M20 40 L30 40 L35 25 L40 55 L45 25 L50 40 L100 40" 
                                  stroke="#00FF00" stroke-width="2" fill="none"/>
                            <circle cx="15" cy="15" r="3" fill="#FF0000"/>
                            <text x="25" y="20" fill="#00FF00" font-size="8">BPM: 72</text>
                        </svg>
                    </div>
                    
                    <!-- Stethoscope -->
                    <div class="classroom-elements" style="bottom: 20%; left: 12%; opacity: 0.15;">
                        <svg width="100" height="100" viewBox="0 0 100 100">
                            <path d="M30 20 Q50 10 70 20" stroke="#2F4F4F" stroke-width="4" fill="none"/>
                            <circle cx="30" cy="20" r="8" fill="#2F4F4F"/>
                            <circle cx="70" cy="20" r="8" fill="#2F4F4F"/>
                            <path d="M50 15 Q50 40 50 60" stroke="#2F4F4F" stroke-width="3" fill="none"/>
                            <circle cx="50" cy="65" r="12" fill="#2F4F4F"/>
                            <circle cx="50" cy="65" r="8" fill="#C0C0C0"/>
                        </svg>
                    </div>
                    
                    <!-- Apple (Healthy Food) -->
                    <div class="apple-teacher" style="bottom: 15%; right: 15%; opacity: 0.2;">
                        <svg width="60" height="80" viewBox="0 0 60 80">
                            <ellipse cx="30" cy="45" rx="20" ry="25" fill="#FF0000"/>
                            <ellipse cx="25" cy="40" rx="15" ry="20" fill="#FF4500"/>
                            <rect x="28" y="15" width="4" height="15" fill="#8B4513"/>
                            <ellipse cx="35" cy="18" rx="8" ry="4" fill="#228B22"/>
                        </svg>
                    </div>
                    
                    <!-- Medical Cross -->
                    <div class="pulse-glow" style="top: 25%; right: 20%; opacity: 0.15;">
                        <svg width="60" height="60" viewBox="0 0 60 60">
                            <rect x="20" y="10" width="20" height="40" fill="#FF0000" rx="3"/>
                            <rect x="10" y="20" width="40" height="20" fill="#FF0000" rx="3"/>
                        </svg>
                    </div>
                    
                    <div class="particle-bg">
                        ${Array.from({length: 20}, (_, i) => `
                            <div class="particle heartbeat" style="
                                left: ${Math.random() * 100}%; 
                                width: ${6 + Math.random() * 10}px; 
                                height: ${6 + Math.random() * 10}px;
                                background: rgba(255, 107, 107, 0.3);
                                animation-delay: ${Math.random() * 2}s;
                            "></div>
                        `).join('')}
                    </div>
                `,
                language: `
                    <!-- Student Reading -->
                    <svg class="student-illustration" style="top: 12%; right: 10%; width: 130px; height: 130px;" viewBox="0 0 200 200" fill="none">
                        <circle cx="100" cy="50" r="25" fill="#FFE4B5" stroke="#D2691E" stroke-width="2"/>
                        <circle cx="90" cy="45" r="2" fill="#000"/>
                        <circle cx="110" cy="45" r="2" fill="#000"/>
                        <path d="M95 55 Q100 60 105 55" stroke="#000" stroke-width="1.5" fill="none"/>
                        <rect x="80" y="75" width="40" height="50" fill="#4B0082" rx="5"/>
                        <text x="100" y="92" text-anchor="middle" fill="#FFF" font-size="6">READ</text>
                        <!-- Open Book -->
                        <rect x="70" y="100" width="60" height="30" fill="#F5F5DC" rx="3"/>
                        <line x1="100" y1="100" x2="100" y2="130" stroke="#000" stroke-width="1"/>
                        <line x1="75" y1="110" x2="95" y2="110" stroke="#000" stroke-width="1"/>
                        <line x1="105" y1="110" x2="125" y2="110" stroke="#000" stroke-width="1"/>
                        <line x1="75" y1="115" x2="95" y2="115" stroke="#000" stroke-width="1"/>
                        <line x1="105" y1="115" x2="125" y2="115" stroke="#000" stroke-width="1"/>
                    </svg>
                    
                    <!-- Library Bookshelf -->
                    <div class="classroom-elements" style="top: 15%; left: 8%; opacity: 0.15;">
                        <svg width="120" height="100" viewBox="0 0 120 100">
                            <rect x="10" y="20" width="100" height="60" fill="#8B4513"/>
                            <rect x="15" y="25" width="8" height="50" fill="#FF6B6B"/>
                            <rect x="25" y="25" width="8" height="50" fill="#4ECDC4"/>
                            <rect x="35" y="25" width="8" height="50" fill="#45B7D1"/>
                            <rect x="45" y="25" width="8" height="50" fill="#96CEB4"/>
                            <rect x="55" y="25" width="8" height="50" fill="#FFEAA7"/>
                            <rect x="65" y="25" width="8" height="50" fill="#DDA0DD"/>
                            <rect x="75" y="25" width="8" height="50" fill="#98FB98"/>
                            <rect x="85" y="25" width="8" height="50" fill="#F0E68C"/>
                            <rect x="95" y="25" width="8" height="50" fill="#FFB6C1"/>
                            <rect x="10" y="45" width="100" height="3" fill="#654321"/>
                        </svg>
                    </div>
                    
                    <!-- Quill and Inkwell -->
                    <div class="pencil-animation" style="bottom: 20%; left: 15%; opacity: 0.2;">
                        <svg width="80" height="60" viewBox="0 0 80 60">
                            <rect x="50" y="10" width="25" height="3" fill="#8B4513"/>
                            <polygon points="75,10 80,13 75,16" fill="#FFD700"/>
                            <circle cx="30" cy="35" r="15" fill="#2F4F4F"/>
                            <circle cx="30" cy="35" r="10" fill="#000"/>
                            <rect x="25" y="20" width="10" height="8" fill="#8B4513"/>
                        </svg>
                    </div>
                    
                    <!-- Dictionary -->
                    <div class="book-flip" style="bottom: 15%; right: 12%; opacity: 0.15;">
                        <svg width="80" height="100" viewBox="0 0 80 100">
                            <rect x="15" y="20" width="50" height="60" fill="#8B0000" rx="3"/>
                            <rect x="20" y="25" width="40" height="50" fill="#F5F5DC"/>
                            <text x="40" y="40" text-anchor="middle" fill="#000" font-size="8">DICT</text>
                            <text x="40" y="50" text-anchor="middle" fill="#000" font-size="6">A-Z</text>
                            <line x1="25" y1="55" x2="55" y2="55" stroke="#000" stroke-width="1"/>
                            <line x1="25" y1="60" x2="55" y2="60" stroke="#000" stroke-width="1"/>
                            <line x1="25" y1="65" x2="55" y2="65" stroke="#000" stroke-width="1"/>
                        </svg>
                    </div>
                    
                    <!-- Speech Bubble -->
                    <div class="floating-animation" style="top: 25%; left: 15%; opacity: 0.2;">
                        <svg width="100" height="80" viewBox="0 0 100 80">
                            <ellipse cx="50" cy="35" rx="40" ry="25" fill="#F0F8FF" stroke="#4169E1" stroke-width="2"/>
                            <polygon points="30,55 25,70 40,60" fill="#F0F8FF" stroke="#4169E1" stroke-width="2"/>
                            <text x="50" y="30" text-anchor="middle" fill="#4169E1" font-size="10">Hello!</text>
                            <text x="50" y="42" text-anchor="middle" fill="#4169E1" font-size="8">Halo!</text>
                        </svg>
                    </div>
                `,
                history: `
                    <!-- Student with Historical Scroll -->
                    <svg class="student-illustration" style="top: 10%; left: 12%; width: 140px; height: 140px;" viewBox="0 0 200 200" fill="none">
                        <circle cx="100" cy="50" r="25" fill="#FFE4B5" stroke="#D2691E" stroke-width="2"/>
                        <circle cx="90" cy="45" r="2" fill="#000"/>
                        <circle cx="110" cy="45" r="2" fill="#000"/>
                        <path d="M95 55 Q100 60 105 55" stroke="#000" stroke-width="1.5" fill="none"/>
                        <rect x="80" y="75" width="40" height="50" fill="#8B4513" rx="5"/>
                        <text x="100" y="92" text-anchor="middle" fill="#FFF" font-size="6">HIST</text>
                        <!-- Historical Scroll -->
                        <rect x="130" y="85" width="30" height="40" fill="#F5DEB3" rx="15"/>
                        <rect x="135" y="90" width="20" height="30" fill="#FFFACD"/>
                        <line x1="140" y1="95" x2="150" y2="95" stroke="#8B4513" stroke-width="1"/>
                        <line x1="140" y1="100" x2="150" y2="100" stroke="#8B4513" stroke-width="1"/>
                        <line x1="140" y1="105" x2="150" y2="105" stroke="#8B4513" stroke-width="1"/>
                        <circle cx="135" cy="87" r="3" fill="#8B4513"/>
                        <circle cx="155" cy="87" r="3" fill="#8B4513"/>
                    </svg>
                    
                    <!-- Ancient Temple -->
                    <div class="school-building" style="bottom: 20%; right: 10%; opacity: 0.15;">
                        <svg width="120" height="100" viewBox="0 0 120 100">
                            <rect x="20" y="60" width="80" height="30" fill="#D2691E"/>
                            <polygon points="10,60 60,20 110,60" fill="#8B4513"/>
                            <rect x="30" y="70" width="8" height="20" fill="#FFFACD"/>
                            <rect x="42" y="70" width="8" height="20" fill="#FFFACD"/>
                            <rect x="54" y="70" width="8" height="20" fill="#FFFACD"/>
                            <rect x="66" y="70" width="8" height="20" fill="#FFFACD"/>
                            <rect x="78" y="70" width="8" height="20" fill="#FFFACD"/>
                            <polygon points="55,30 65,30 60,25" fill="#FFD700"/>
                        </svg>
                    </div>
                    
                    <!-- Crown -->
                    <div class="rotate-animation" style="top: 20%; right: 5%; opacity: 0.15;">
                        <svg width="80" height="60" viewBox="0 0 80 60">
                            <polygon points="10,40 20,20 30,35 40,15 50,35 60,20 70,40 10,40" fill="#FFD700"/>
                            <rect x="10" y="40" width="60" height="8" fill="#DAA520"/>
                            <circle cx="20" cy="25" r="3" fill="#FF0000"/>
                            <circle cx="40" cy="20" r="4" fill="#0000FF"/>
                            <circle cx="60" cy="25" r="3" fill="#FF0000"/>
                        </svg>
                    </div>
                    
                    <!-- Ancient Coin -->
                    <div class="floating-animation" style="bottom: 25%; left: 8%; opacity: 0.2;">
                        <svg width="60" height="60" viewBox="0 0 60 60">
                            <circle cx="30" cy="30" r="25" fill="#DAA520" stroke="#B8860B" stroke-width="2"/>
                            <circle cx="30" cy="30" r="20" fill="none" stroke="#B8860B" stroke-width="1"/>
                            <text x="30" y="35" text-anchor="middle" fill="#8B4513" font-size="12">古</text>
                        </svg>
                    </div>
                    
                    <!-- Pyramid -->
                    <div class="classroom-elements" style="top: 25%; left: 5%; opacity: 0.1;">
                        <svg width="100" height="80" viewBox="0 0 100 80">
                            <polygon points="50,10 10,70 90,70" fill="#DEB887"/>
                            <polygon points="50,10 90,70 70,70 50,30" fill="#D2B48C"/>
                            <rect x="45" y="50" width="10" height="20" fill="#8B4513"/>
                        </svg>
                    </div>
                `,
                economics: `
                    <!-- Student with Calculator and Charts -->
                    <svg class="student-illustration" style="top: 12%; right: 8%; width: 140px; height: 140px;" viewBox="0 0 200 200" fill="none">
                        <circle cx="100" cy="50" r="25" fill="#FFE4B5" stroke="#D2691E" stroke-width="2"/>
                        <circle cx="90" cy="45" r="2" fill="#000"/>
                        <circle cx="110" cy="45" r="2" fill="#000"/>
                        <path d="M95 55 Q100 60 105 55" stroke="#000" stroke-width="1.5" fill="none"/>
                        <rect x="80" y="75" width="40" height="50" fill="#191970" rx="5"/>
                        <text x="100" y="92" text-anchor="middle" fill="#FFF" font-size="6">BIZ</text>
                        <!-- Business Chart -->
                        <rect x="130" y="85" width="40" height="30" fill="#F5F5F5" stroke="#000"/>
                        <polyline points="135,110 140,105 145,100 150,95 155,90 160,85 165,90" 
                                  stroke="#00FF00" stroke-width="2" fill="none"/>
                        <text x="147" y="120" text-anchor="middle" fill="#000" font-size="6">PROFIT</text>
                    </svg>
                    
                    <!-- Stock Market Display -->
                    <div class="classroom-elements" style="top: 15%; left: 10%; opacity: 0.2;">
                        <svg width="120" height="80" viewBox="0 0 120 80">
                            <rect x="10" y="10" width="100" height="60" fill="#000" rx="5"/>
                            <text x="60" y="25" text-anchor="middle" fill="#00FF00" font-size="8">MARKET</text>
                            <text x="30" y="40" fill="#00FF00" font-size="6">NASDAQ +2.5%</text>
                            <text x="30" y="50" fill="#FF0000" font-size="6">DOW -1.2%</text>
                            <text x="30" y="60" fill="#00FF00" font-size="6">S&P500 +0.8%</text>
                            <polyline points="15,45 25,40 35,35 45,30 55,25 65,30 75,25 85,20 95,25" 
                                      stroke="#00FF00" stroke-width="1" fill="none"/>
                        </svg>
                    </div>
                    
                    <!-- Money Coins -->
                    <div class="floating-animation" style="bottom: 20%; left: 12%; opacity: 0.15;">
                        <svg width="100" height="80" viewBox="0 0 100 80">
                            <circle cx="30" cy="30" r="15" fill="#FFD700" stroke="#DAA520" stroke-width="2"/>
                            <text x="30" y="35" text-anchor="middle" fill="#B8860B" font-size="8">$</text>
                            <circle cx="60" cy="45" r="12" fill="#C0C0C0" stroke="#A9A9A9" stroke-width="2"/>
                            <text x="60" y="50" text-anchor="middle" fill="#696969" font-size="6">¢</text>
                            <circle cx="45" cy="60" r="10" fill="#CD7F32" stroke="#A0522D" stroke-width="2"/>
                            <text x="45" y="65" text-anchor="middle" fill="#8B4513" font-size="6">€</text>
                        </svg>
                    </div>
                    
                    <!-- Business Building -->
                    <div class="school-building" style="bottom: 15%; right: 15%; opacity: 0.1;">
                        <svg width="100" height="120" viewBox="0 0 100 120">
                            <rect x="20" y="40" width="60" height="70" fill="#4682B4"/>
                            <rect x="25" y="45" width="8" height="8" fill="#F0F8FF"/>
                            <rect x="37" y="45" width="8" height="8" fill="#F0F8FF"/>
                            <rect x="49" y="45" width="8" height="8" fill="#F0F8FF"/>
                            <rect x="61" y="45" width="8" height="8" fill="#F0F8FF"/>
                            <rect x="25" y="57" width="8" height="8" fill="#F0F8FF"/>
                            <rect x="37" y="57" width="8" height="8" fill="#F0F8FF"/>
                            <rect x="49" y="57" width="8" height="8" fill="#F0F8FF"/>
                            <rect x="61" y="57" width="8" height="8" fill="#F0F8FF"/>
                            <rect x="25" y="69" width="8" height="8" fill="#F0F8FF"/>
                            <rect x="37" y="69" width="8" height="8" fill="#F0F8FF"/>
                            <rect x="49" y="69" width="8" height="8" fill="#F0F8FF"/>
                            <rect x="61" y="69" width="8" height="8" fill="#F0F8FF"/>
                            <rect x="42" y="90" width="16" height="20" fill="#8B4513"/>
                            <text x="50" y="35" text-anchor="middle" fill="#191970" font-size="8">CORP</text>
                        </svg>
                    </div>
                    
                    <!-- Calculator -->
                    <div class="calculator-math" style="top: 25%; left: 8%; opacity: 0.15;">
                        <svg width="80" height="100" viewBox="0 0 80 100">
                            <rect x="10" y="10" width="60" height="80" fill="#2F4F4F" rx="5"/>
                            <rect x="15" y="15" width="50" height="20" fill="#000" rx="3"/>
                            <text x="40" y="28" text-anchor="middle" fill="#00FF00" font-size="8">123,456</text>
                            <rect x="18" y="40" width="12" height="8" fill="#696969" rx="2"/>
                            <rect x="34" y="40" width="12" height="8" fill="#696969" rx="2"/>
                            <rect x="50" y="40" width="12" height="8" fill="#696969" rx="2"/>
                            <rect x="18" y="52" width="12" height="8" fill="#696969" rx="2"/>
                            <rect x="34" y="52" width="12" height="8" fill="#696969" rx="2"/>
                            <rect x="50" y="52" width="12" height="8" fill="#FF6347" rx="2"/>
                            <text x="24" y="46" text-anchor="middle" fill="#FFF" font-size="6">7</text>
                            <text x="40" y="46" text-anchor="middle" fill="#FFF" font-size="6">8</text>
                            <text x="56" y="46" text-anchor="middle" fill="#FFF" font-size="6">9</text>
                            <text x="56" y="58" text-anchor="middle" fill="#FFF" font-size="6">=</text>
                        </svg>
                    </div>
                `,
                arts: `
                    <!-- Student with Art Palette -->
                    <svg class="student-illustration" style="top: 10%; left: 8%; width: 140px; height: 140px;" viewBox="0 0 200 200" fill="none">
                        <circle cx="100" cy="50" r="25" fill="#FFE4B5" stroke="#D2691E" stroke-width="2"/>
                        <circle cx="90" cy="45" r="2" fill="#000"/>
                        <circle cx="110" cy="45" r="2" fill="#000"/>
                        <path d="M95 55 Q100 60 105 55" stroke="#000" stroke-width="1.5" fill="none"/>
                        <rect x="80" y="75" width="40" height="50" fill="#FF69B4" rx="5"/>
                        <text x="100" y="92" text-anchor="middle" fill="#FFF" font-size="6">ART</text>
                        <!-- Art Palette -->
                        <ellipse cx="140" cy="100" rx="25" ry="15" fill="#F5F5DC" stroke="#8B4513" stroke-width="2"/>
                        <circle cx="130" cy="95" r="3" fill="#FF0000"/>
                        <circle cx="140" cy="92" r="3" fill="#00FF00"/>
                        <circle cx="150" cy="95" r="3" fill="#0000FF"/>
                        <circle cx="135" cy="105" r="3" fill="#FFFF00"/>
                        <circle cx="145" cy="105" r="3" fill="#FF00FF"/>
                        <!-- Paintbrush -->
                        <rect x="160" y="85" width="3" height="20" fill="#8B4513"/>
                        <ellipse cx="161.5" cy="82" rx="4" ry="6" fill="#C0C0C0"/>
                    </svg>
                    
                    <!-- Musical Notes -->
                    <div class="floating-animation" style="top: 20%; right: 10%; opacity: 0.2;">
                        <svg width="100" height="80" viewBox="0 0 100 80">
                            <circle cx="20" cy="50" r="8" fill="#000"/>
                            <rect x="28" y="25" width="2" height="25" fill="#000"/>
                            <circle cx="50" cy="40" r="6" fill="#000"/>
                            <rect x="56" y="20" width="2" height="20" fill="#000"/>
                            <circle cx="80" cy="60" r="8" fill="#000"/>
                            <rect x="88" y="35" width="2" height="25" fill="#000"/>
                            <path d="M30 25 Q40 20 58 20" stroke="#000" stroke-width="2" fill="none"/>
                        </svg>
                    </div>
                    
                    <!-- Color Wheel -->
                    <div class="rotate-animation" style="bottom: 20%; right: 15%; opacity: 0.15;">
                        <svg width="100" height="100" viewBox="0 0 100 100">
                            <circle cx="50" cy="50" r="40" fill="none" stroke="#000" stroke-width="2"/>
                            <path d="M50 10 A40 40 0 0 1 85.36 30" fill="#FF0000"/>
                            <path d="M85.36 30 A40 40 0 0 1 85.36 70" fill="#FFFF00"/>
                            <path d="M85.36 70 A40 40 0 0 1 50 90" fill="#00FF00"/>
                            <path d="M50 90 A40 40 0 0 1 14.64 70" fill="#00FFFF"/>
                            <path d="M14.64 70 A40 40 0 0 1 14.64 30" fill="#0000FF"/>
                            <path d="M14.64 30 A40 40 0 0 1 50 10" fill="#FF00FF"/>
                            <circle cx="50" cy="50" r="15" fill="#FFF"/>
                        </svg>
                    </div>
                    
                    <!-- Dance Figure -->
                    <div class="bounce-animation" style="bottom: 15%; left: 12%; opacity: 0.2;">
                        <svg width="80" height="120" viewBox="0 0 80 120">
                            <circle cx="40" cy="20" r="12" fill="#FFE4B5"/>
                            <rect x="35" y="32" width="10" height="30" fill="#FF69B4"/>
                            <rect x="30" y="45" width="20" height="3" fill="#FFE4B5"/>
                            <rect x="32" y="62" width="6" height="25" fill="#4169E1"/>
                            <rect x="42" y="62" width="6" height="25" fill="#4169E1"/>
                            <ellipse cx="35" cy="90" rx="8" ry="4" fill="#000"/>
                            <ellipse cx="45" cy="90" rx="8" ry="4" fill="#000"/>
                            <path d="M25 40 Q20 35 15 45" stroke="#FFE4B5" stroke-width="3" fill="none"/>
                            <path d="M55 40 Q60 35 65 45" stroke="#FFE4B5" stroke-width="3" fill="none"/>
                        </svg>
                    </div>
                    
                    <!-- Art Canvas -->
                    <div class="classroom-elements" style="top: 25%; left: 15%; opacity: 0.1;">
                        <svg width="100" height="80" viewBox="0 0 100 80">
                            <rect x="15" y="15" width="70" height="50" fill="#F5F5DC" stroke="#8B4513" stroke-width="3"/>
                            <rect x="20" y="20" width="60" height="40" fill="#FFF"/>
                            <circle cx="35" cy="35" r="8" fill="#FFD700"/>
                            <polygon points="50,25 55,35 65,35 57,42 60,52 50,47 40,52 43,42 35,35 45,35" fill="#FF69B4"/>
                            <rect x="25" y="45" width="20" height="8" fill="#32CD32"/>
                            <triangle points="60,45 70,45 65,55" fill="#FF6347"/>
                        </svg>
                    </div>
                `,
                geography: `
                    <!-- Student with Globe -->
                    <svg class="student-illustration" style="top: 12%; right: 10%; width: 140px; height: 140px;" viewBox="0 0 200 200" fill="none">
                        <circle cx="100" cy="50" r="25" fill="#FFE4B5" stroke="#D2691E" stroke-width="2"/>
                        <circle cx="90" cy="45" r="2" fill="#000"/>
                        <circle cx="110" cy="45" r="2" fill="#000"/>
                        <path d="M95 55 Q100 60 105 55" stroke="#000" stroke-width="1.5" fill="none"/>
                        <rect x="80" y="75" width="40" height="50" fill="#4682B4" rx="5"/>
                        <text x="100" y="92" text-anchor="middle" fill="#FFF" font-size="6">GEO</text>
                        <!-- Globe -->
                        <circle cx="140" cy="100" r="20" fill="#4169E1"/>
                        <path d="M125 100 Q140 90 155 100" fill="#228B22"/>
                        <path d="M125 110 Q140 100 155 110" fill="#228B22"/>
                        <path d="M130 85 Q140 95 150 85" fill="#228B22"/>
                        <rect x="138" y="80" width="4" height="40" fill="#8B4513"/>
                        <ellipse cx="140" cy="120" rx="15" ry="5" fill="#2F4F4F"/>
                    </svg>
                    
                    <!-- World Map -->
                    <div class="classroom-elements" style="top: 15%; left: 8%; opacity: 0.15;">
                        <svg width="140" height="80" viewBox="0 0 140 80">
                            <rect x="10" y="10" width="120" height="60" fill="#87CEEB"/>
                            <!-- Continents -->
                            <path d="M20 25 L35 20 L45 30 L40 40 L25 35 Z" fill="#228B22"/>
                            <path d="M50 15 L70 18 L75 25 L80 35 L70 40 L55 35 L50 25 Z" fill="#228B22"/>
                            <path d="M85 20 L100 22 L110 30 L105 45 L90 40 L85 30 Z" fill="#228B22"/>
                            <path d="M25 45 L40 48 L45 55 L35 60 L20 55 Z" fill="#228B22"/>
                            <path d="M115 25 L125 28 L128 35 L125 45 L115 40 Z" fill="#228B22"/>
                        </svg>
                    </div>
                    
                    <!-- Compass -->
                    <div class="rotate-animation" style="bottom: 20%; left: 12%; opacity: 0.2;">
                        <svg width="80" height="80" viewBox="0 0 80 80">
                            <circle cx="40" cy="40" r="35" fill="#F5F5DC" stroke="#8B4513" stroke-width="3"/>
                            <circle cx="40" cy="40" r="30" fill="none" stroke="#000" stroke-width="1"/>
                            <polygon points="40,15 45,35 40,40 35,35" fill="#FF0000"/>
                            <polygon points="40,65 35,45 40,40 45,45" fill="#FFF" stroke="#000"/>
                            <text x="40" y="12" text-anchor="middle" fill="#000" font-size="8">N</text>
                            <text x="68" y="45" text-anchor="middle" fill="#000" font-size="8">E</text>
                            <text x="40" y="75" text-anchor="middle" fill="#000" font-size="8">S</text>
                            <text x="12" y="45" text-anchor="middle" fill="#000" font-size="8">W</text>
                        </svg>
                    </div>
                    
                    <!-- Mountain Range -->
                    <div class="classroom-elements" style="bottom: 15%; right: 15%; opacity: 0.1;">
                        <svg width="120" height="80" viewBox="0 0 120 80">
                            <polygon points="20,60 40,20 60,60" fill="#8B7355"/>
                            <polygon points="50,60 70,15 90,60" fill="#A0522D"/>
                            <polygon points="80,60 100,25 120,60" fill="#8B7355"/>
                            <polygon points="70,15 75,10 80,15" fill="#FFF"/>
                            <polygon points="35,25 42,18 49,25" fill="#FFF"/>
                            <rect x="0" y="60" width="120" height="20" fill="#228B22"/>
                        </svg>
                    </div>
                    
                    <!-- Airplane -->
                    <div class="floating-animation" style="top: 25%; right: 5%; opacity: 0.15;">
                        <svg width="100" height="60" viewBox="0 0 100 60">
                            <ellipse cx="50" cy="30" rx="35" ry="8" fill="#C0C0C0"/>
                            <rect x="45" y="22" width="10" height="16" fill="#4169E1"/>
                            <polygon points="15,28 35,25 35,35 15,32" fill="#C0C0C0"/>
                            <polygon points="65,25 85,28 85,32 65,35" fill="#C0C0C0"/>
                            <polygon points="75,15 85,20 85,25 75,22" fill="#C0C0C0"/>
                            <circle cx="25" cy="35" r="3" fill="#2F4F4F"/>
                            <circle cx="75" cy="35" r="3" fill="#2F4F4F"/>
                        </svg>
                    </div>
                `,
                technology: `
                    <div class="circuit-lines"></div>
                    
                    <!-- Student with Laptop -->
                    <svg class="student-illustration" style="top: 10%; left: 10%; width: 140px; height: 140px;" viewBox="0 0 200 200" fill="none">
                        <circle cx="100" cy="50" r="25" fill="#FFE4B5" stroke="#D2691E" stroke-width="2"/>
                        <circle cx="90" cy="45" r="2" fill="#000"/>
                        <circle cx="110" cy="45" r="2" fill="#000"/>
                        <path d="M95 55 Q100 60 105 55" stroke="#000" stroke-width="1.5" fill="none"/>
                        <rect x="80" y="75" width="40" height="50" fill="#2F4F4F" rx="5"/>
                        <text x="100" y="92" text-anchor="middle" fill="#FFF" font-size="6">TECH</text>
                        <!-- Laptop -->
                        <rect x="130" y="95" width="40" height="25" fill="#2F4F4F" rx="2"/>
                        <rect x="132" y="97" width="36" height="18" fill="#000"/>
                        <rect x="134" y="99" width="32" height="14" fill="#00FF00"/>
                        <text x="150" y="108" text-anchor="middle" fill="#000" font-size="6">CODE</text>
                        <rect x="130" y="120" width="40" height="3" fill="#696969"/>
                    </svg>
                    
                    <!-- Robot -->
                    <div class="bounce-animation" style="top: 20%; right: 8%; opacity: 0.2;">
                        <svg width="100" height="120" viewBox="0 0 100 120">
                            <rect x="35" y="30" width="30" height="40" fill="#C0C0C0" rx="5"/>
                            <rect x="30" y="25" width="40" height="20" fill="#A9A9A9" rx="10"/>
                            <circle cx="42" cy="35" r="3" fill="#00FF00"/>
                            <circle cx="58" cy="35" r="3" fill="#00FF00"/>
                            <rect x="45" y="40" width="10" height="3" fill="#000"/>
                            <rect x="25" y="50" width="8" height="15" fill="#696969" rx="4"/>
                            <rect x="67" y="50" width="8" height="15" fill="#696969" rx="4"/>
                            <rect x="40" y="70" width="8" height="20" fill="#696969" rx="4"/>
                            <rect x="52" y="70" width="8" height="20" fill="#696969" rx="4"/>
                            <circle cx="44" cy="95" r="5" fill="#2F4F4F"/>
                            <circle cx="56" cy="95" r="5" fill="#2F4F4F"/>
                            <!-- Antenna -->
                            <rect x="49" y="15" width="2" height="10" fill="#FFD700"/>
                            <circle cx="50" cy="12" r="3" fill="#FF0000"/>
                        </svg>
                    </div>
                    
                    <!-- Computer Monitor -->
                    <div class="classroom-elements" style="bottom: 20%; left: 12%; opacity: 0.15;">
                        <svg width="120" height="100" viewBox="0 0 120 100">
                            <rect x="20" y="20" width="80" height="50" fill="#2F4F4F" rx="5"/>
                            <rect x="25" y="25" width="70" height="40" fill="#000"/>
                            <rect x="30" y="30" width="60" height="30" fill="#008000"/>
                            <text x="60" y="40" text-anchor="middle" fill="#00FF00" font-size="6">SYSTEM READY</text>
                            <text x="35" y="50" fill="#00FF00" font-size="4">C:\> run program.exe</text>
                            <text x="35" y="55" fill="#00FF00" font-size="4">Loading...</text>
                            <rect x="55" y="70" width="10" height="15" fill="#696969"/>
                            <ellipse cx="60" cy="90" rx="20" ry="5" fill="#A9A9A9"/>
                        </svg>
                    </div>
                    
                    <!-- Smartphone -->
                    <div class="floating-animation" style="bottom: 15%; right: 15%; opacity: 0.2;">
                        <svg width="60" height="100" viewBox="0 0 60 100">
                            <rect x="15" y="10" width="30" height="80" fill="#000" rx="8"/>
                            <rect x="18" y="15" width="24" height="40" fill="#4169E1"/>
                            <circle cx="30" cy="25" r="2" fill="#FFF"/>
                            <rect x="25" y="30" width="10" height="2" fill="#FFF"/>
                            <rect x="22" y="35" width="16" height="2" fill="#FFF"/>
                            <rect x="20" y="40" width="20" height="2" fill="#FFF"/>
                            <circle cx="30" cy="80" r="6" fill="#2F4F4F"/>
                        </svg>
                    </div>
                    
                    <!-- Satellite -->
                    <div class="rotate-animation" style="top: 25%; right: 20%; opacity: 0.1;">
                        <svg width="100" height="80" viewBox="0 0 100 80">
                            <rect x="40" y="30" width="20" height="20" fill="#C0C0C0"/>
                            <rect x="20" y="35" width="20" height="10" fill="#4169E1"/>
                            <rect x="60" y="35" width="20" height="10" fill="#4169E1"/>
                            <rect x="45" y="15" width="10" height="15" fill="#FFD700"/>
                            <rect x="45" y="50" width="10" height="15" fill="#FFD700"/>
                            <circle cx="50" cy="40" r="3" fill="#FF0000"/>
                        </svg>
                    </div>
                    
                    <div class="particle-bg">
                        ${Array.from({length: 25}, (_, i) => `
                            <div class="particle" style="
                                left: ${Math.random() * 100}%; 
                                width: ${3 + Math.random() * 6}px; 
                                height: ${3 + Math.random() * 6}px;
                                background: rgba(0, 255, 136, 0.3);
                                animation-delay: ${Math.random() * 6}s;
                                animation-duration: ${3 + Math.random() * 4}s;
                            "></div>
                        `).join('')}
                    </div>
                `
</script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9930e463833d4008',t:'MTc2MTIxODkxOS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
